<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/blog/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="keywords" content="MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="https://masol.gitee.io/blog/2018/02/05/mysql.all/index.html">
<meta property="og:site_name" content="Liisyu Blog">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/FameLsy/Images/master/Fullmetal%20Alchemist/wallhaven-389524.png">
<meta property="og:updated_time" content="2019-04-11T09:35:43.230Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL">
<meta name="twitter:image" content="https://raw.githubusercontent.com/FameLsy/Images/master/Fullmetal%20Alchemist/wallhaven-389524.png">





  
  
  <link rel="canonical" href="https://masol.gitee.io/blog/2018/02/05/mysql.all/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>MySQL | Liisyu Blog</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Liisyu Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/blog/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/blog/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/blog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-navigation">

    
    
    
      
    

    

    <a href="/blog/navigation/" rel="section"><i class="menu-item-icon fa fa-fw fa-diamond"></i> <br>导航</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://masol.gitee.io/blog/blog/2018/02/05/mysql.all/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liisyu">
      <meta itemprop="description" content="我只是一个兴趣使然的程序员">
      <meta itemprop="image" content="/blog/images/toux.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liisyu Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MySQL

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-02-05 00:00:01" itemprop="dateCreated datePublished" datetime="2018-02-05T00:00:01-05:00">2018-02-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-11 05:35:43" itemprop="dateModified" datetime="2019-04-11T05:35:43-04:00">2019-04-11</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/blog/categories/DataBase/" itemprop="url" rel="index"><span itemprop="name">DataBase</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://raw.githubusercontent.com/FameLsy/Images/master/Fullmetal%20Alchemist/wallhaven-389524.png" alt></p>
<a id="more"></a>
<h1 id="命令行操作"><a href="#命令行操作" class="headerlink" title="命令行操作"></a>命令行操作</h1><h2 id="登录MySQL"><a href="#登录MySQL" class="headerlink" title="登录MySQL"></a>登录MySQL</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p </span><br><span class="line"><span class="comment">//指定用户(-u)、密码登录(-p)、主机(-h,默认localhost)、端口(-P,3306)；</span></span><br><span class="line">mysql -u root -p -h myserver -P <span class="number">9999</span></span><br></pre></td></tr></table></figure></div>
<h2 id="查看帮助文档"><a href="#查看帮助文档" class="headerlink" title="查看帮助文档"></a>查看帮助文档</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//例如查看指令**SELECT**</span></span><br><span class="line">help SELECT</span><br></pre></td></tr></table></figure></div>
<h2 id="退出操作"><a href="#退出操作" class="headerlink" title="退出操作"></a>退出操作</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exit</span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line">quit</span><br></pre></td></tr></table></figure></div>
<h2 id="测试服务器"><a href="#测试服务器" class="headerlink" title="测试服务器"></a>测试服务器</h2><p>》 查看mysql的一些基本信息：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysqladmin -u root -p version</span><br></pre></td></tr></table></figure></div>
<p>》 查看mysql的变量:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysqladmin -u root -p variables</span><br></pre></td></tr></table></figure></div>
<p>》 验证是否能关闭mysql:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysqladmin -u root -p shutdown</span><br></pre></td></tr></table></figure></div>
<p>》 再次启动Mysql:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysqld_safe --user=mysql &amp;</span><br></pre></td></tr></table></figure></div>
<p>》 查看数据库:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysqlshow -u root -p</span><br><span class="line"><span class="comment">//指定数据库则显示数据库中的表</span></span><br><span class="line">/usr/bin/mysqlshow -u root -p  test</span><br></pre></td></tr></table></figure></div>
<p>》 查看表中主句:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/mysql -e <span class="string">"SELECT prod_name FROM products"</span> -u root -p test</span><br></pre></td></tr></table></figure></div>
<p>》 显示服务器状态：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql status</span><br></pre></td></tr></table></figure></div>
<h2 id="导入sql文件"><a href="#导入sql文件" class="headerlink" title="导入sql文件"></a>导入sql文件</h2><p>》 命令行模式：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//（指定sql文件的完全路径）</span></span><br><span class="line">source [$&#123;path&#125;.*sql]</span><br></pre></td></tr></table></figure></div>
<h1 id="数据库相关操作"><a href="#数据库相关操作" class="headerlink" title="数据库相关操作"></a>数据库相关操作</h1><h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE &lt;database-name&gt; [CHARACTER SET 字符集]</span><br></pre></td></tr></table></figure></div>
<h2 id="使用数据库"><a href="#使用数据库" class="headerlink" title="使用数据库"></a>使用数据库</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE &lt;database-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="查看所有数据库"><a href="#查看所有数据库" class="headerlink" title="查看所有数据库"></a>查看所有数据库</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW DATABASES;</span><br></pre></td></tr></table></figure></div>
<h2 id="显示创建数据库语句"><a href="#显示创建数据库语句" class="headerlink" title="显示创建数据库语句"></a>显示创建数据库语句</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE DATABASE &lt;Databasee-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP DATABASE &lt;database-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="查看正在使用的数据库"><a href="#查看正在使用的数据库" class="headerlink" title="查看正在使用的数据库"></a>查看正在使用的数据库</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT database()</span><br></pre></td></tr></table></figure></div>
<h1 id="表相关操作"><a href="#表相关操作" class="headerlink" title="表相关操作"></a>表相关操作</h1><h2 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &lt;table-name&gt; (</span><br><span class="line">	&lt;column-name&gt; 类型(长度) 约束,</span><br><span class="line">	&lt;column-name&gt; 类型(长度) 约束</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不存在则创建</span></span><br><span class="line">CREATE TABLE IF NOT EXISTS &lt;table-name&gt;(</span><br><span class="line">	&lt;column-name&gt; 类型(长度) 约束,</span><br><span class="line">	&lt;column-name&gt; 类型(长度) 约束</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>
<hr>
<p>》 约束</p>
<ul>
<li>NULL或NOT NULL:在定义列时加入这两个关键字，表示允许NULL或不允许NULL,默认为NULL</li>
<li>PRIMARY KEY (column1,column2 ): 定义主键/组合主键</li>
<li>AUTO_INCREMENT:  自动增量,每次执行INSERT，自动对该列增量，赋值下一个可用的值。可以在INSERT语句中插入指定值，只要是没有使用的，该值回代替自动生成的值。</li>
<li>DEFAULT &lt; value &gt;:指定默认值</li>
</ul>
<h2 id="查看当前数据库所有表"><a href="#查看当前数据库所有表" class="headerlink" title="查看当前数据库所有表:"></a>查看当前数据库所有表:</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW TABLES;</span><br></pre></td></tr></table></figure></div>
<h2 id="显示创建表语句"><a href="#显示创建表语句" class="headerlink" title="显示创建表语句"></a>显示创建表语句</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE TABLE &lt;table-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="查看表列-结构"><a href="#查看表列-结构" class="headerlink" title="查看表列(结构)"></a>查看表列(结构)</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW COLUMNS FROM &lt;table-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="查看表列另一种方式-效果一样"><a href="#查看表列另一种方式-效果一样" class="headerlink" title="查看表列另一种方式(效果一样)"></a>查看表列另一种方式(效果一样)</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DESCRIBE &lt;table-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="查看自动增量的值"><a href="#查看自动增量的值" class="headerlink" title="查看自动增量的值"></a>查看自动增量的值</h2><p>(该函数回获取最后一个AUTO_INCREATEMENT的值)</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT last_insert_id()</span><br></pre></td></tr></table></figure></div>
<h2 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h2><p>》 添加列</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table-name&gt; ADD &lt;column-name&gt; 类型(长度) 约束;</span><br></pre></td></tr></table></figure></div>
<p>》 修改类类型、长度、约束</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table-name&gt; MODIFY &lt;column-name&gt; 类型(长度) 约束;</span><br></pre></td></tr></table></figure></div>
<p>》 修改列名</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table-name&gt; CHANGE &lt;old-column-name&gt; &lt;new-column-name&gt; 类型(长度) 约束;</span><br></pre></td></tr></table></figure></div>
<p>》 删除列 </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table-name&gt; DROP &lt;column-name&gt;</span><br></pre></td></tr></table></figure></div>
<p>》 修改表名</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME TABLE &lt;old-table-name&gt; TO &lt;new-table-name&gt;</span><br></pre></td></tr></table></figure></div>
<p>》 修改表的字符集</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table-name&gt; CHARACTER SET 字符集;</span><br></pre></td></tr></table></figure></div>
<h2 id="定义外键"><a href="#定义外键" class="headerlink" title="定义外键"></a>定义外键</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE &lt;table-name&gt;</span><br><span class="line">	ADD CONSTRAINT &lt;约束名称&gt;</span><br><span class="line">	FOREIGN KEY(主表外键字段)</span><br><span class="line">	REFERENCES 从表(从表主键)</span><br></pre></td></tr></table></figure></div>
<p>》 示例：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//外键属性</span></span><br><span class="line"><span class="comment">//- fk_orderitems_orders：外键字段的名字</span></span><br><span class="line"><span class="comment">//- FOREIGN KEY(order_num)：当前表的外键字段</span></span><br><span class="line"><span class="comment">//- REFERENCES orders(order_num)：对应的表的字段(orders表的order_num字段)</span></span><br><span class="line"></span><br><span class="line">ALTER TABLE orderitems</span><br><span class="line">ADD CONSTRAINT fk_orderitems_orders</span><br><span class="line"><span class="function">FOREIGN <span class="title">KEY</span><span class="params">(order_num)</span> </span></span><br><span class="line"><span class="function">REFERENCES <span class="title">orders</span><span class="params">(order_num)</span></span></span><br></pre></td></tr></table></figure></div>
<h2 id="删除外键"><a href="#删除外键" class="headerlink" title="删除外键"></a>删除外键</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE DROP FOREIGN KEY 外键字段名</span><br></pre></td></tr></table></figure></div>
<h1 id="用户相关操作"><a href="#用户相关操作" class="headerlink" title="用户相关操作"></a>用户相关操作</h1><p><strong>注意:日常开发不应使用root用户</strong></p>
<h2 id="获取所有账号列表"><a href="#获取所有账号列表" class="headerlink" title="获取所有账号列表,"></a>获取所有账号列表,</h2><p>》 系统的 mysql 数据库存放了用户信息表 user </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">USE mysql;</span><br><span class="line">SELECT user FORM user;</span><br></pre></td></tr></table></figure></div>
<h2 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER 用户名 </span><br><span class="line"># 创建用户并指定密码</span><br><span class="line">CREATE USER 用户名 IDENTIFIED BY &apos;密码&apos;</span><br></pre></td></tr></table></figure></div>
<h2 id="重命名"><a href="#重命名" class="headerlink" title="重命名"></a>重命名</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME USER 原名 TO 更改名</span><br></pre></td></tr></table></figure></div>
<h2 id="设置-更新密码"><a href="#设置-更新密码" class="headerlink" title="设置/更新密码"></a>设置/更新密码</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD</span><br></pre></td></tr></table></figure></div>
<p>》 示例1 ：设置指定用户密码， Password（） 函数加密</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD FOR famel = Password(&apos;123456&apos;)</span><br></pre></td></tr></table></figure></div>
<p>》 示例2 ：设置当前登录用户</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET PASSWORD =Password(&apos;123456&apos;)</span><br></pre></td></tr></table></figure></div>
<h2 id="删除账号"><a href="#删除账号" class="headerlink" title="删除账号"></a>删除账号</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP USER 用户名</span><br></pre></td></tr></table></figure></div>
<p>》 查看用户权限(新用户没有任何权限，只能登录MySQL)</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW GRANTS FOR 用户名</span><br></pre></td></tr></table></figure></div>
<h2 id="授权"><a href="#授权" class="headerlink" title="授权"></a>授权</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT 权限 ON 数据库.表 TO 用户</span><br></pre></td></tr></table></figure></div>
<p>》 示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//赋予了 famle 用户关于数据库 crashcourse 下所有表的 SELECT 权限</span></span><br><span class="line"> </span><br><span class="line">GRANT SELECT ON crashcourse.* TO famel</span><br></pre></td></tr></table></figure></div>
<p>授权多次,权限用 “,” 分隔</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT SELECT, INSERT ON database.table TO famel;</span><br></pre></td></tr></table></figure></div>
<h2 id="删除权限"><a href="#删除权限" class="headerlink" title="删除权限"></a>删除权限</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REVOKE 权限 ON 表 FROM 用户</span><br></pre></td></tr></table></figure></div>
<p>》 GRENT 和 REVOKE 可以在几个层次上控制访问权限</p>
<ul>
<li>整个服务器， GRANT ALL 和 REVOKE ALL </li>
<li>整个数据库, ON database.* </li>
<li>特定表, ON database.table </li>
<li>特定列</li>
<li>特定存储过程</li>
</ul>
<h2 id="可用权限"><a href="#可用权限" class="headerlink" title="可用权限"></a>可用权限</h2><table>
<thead>
<tr>
<th>权 限</th>
<th>说 明</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALL</td>
<td>除GRANT OPTION外的所有权限</td>
</tr>
<tr>
<td>ALTER</td>
<td>使用ALTER TABLE</td>
</tr>
<tr>
<td>ALTER ROUTINE</td>
<td>使用ALTER PROCEDURE</td>
</tr>
<tr>
<td>CREATE</td>
<td>使用CREATE TABLE</td>
</tr>
<tr>
<td>CREATE ROUTINE</td>
<td>使用CREATE PROCEDURE</td>
</tr>
<tr>
<td>CREATE TEMPORARYTABLES</td>
<td>使用CREATE TEMPORARY TABLE</td>
</tr>
<tr>
<td>CREATE USER</td>
<td>使用CREATE USER、DROP USER、RENAME USER和REVOKEALL PRIVILEGES</td>
</tr>
<tr>
<td>CREATE VIEW</td>
<td>使用CREATE VIEW</td>
</tr>
<tr>
<td>DELETE</td>
<td>使用DELETE</td>
</tr>
<tr>
<td>DROP</td>
<td>使用DROP TABLE</td>
</tr>
<tr>
<td>EXECUTE</td>
<td>使用CALL和存储过程</td>
</tr>
<tr>
<td>FILE</td>
<td>使用SELECT INTO OUTFILE和LOAD DATA INFILE</td>
</tr>
<tr>
<td>GRANT OPTION</td>
<td>使用GRANT和REVOKE</td>
</tr>
<tr>
<td>INDEX</td>
<td>使用CREATE INDEX和DROP INDEX</td>
</tr>
<tr>
<td>INSERT</td>
<td>使用INSERT</td>
</tr>
<tr>
<td>LOCK TABLES</td>
<td>使用LOCK TABLES</td>
</tr>
<tr>
<td>PROCESS</td>
<td>使用SHOW FULL PROCESSLIST</td>
</tr>
<tr>
<td>RELOAD</td>
<td>使用FLUSH</td>
</tr>
<tr>
<td>REPLICATION CLIENT</td>
<td>服务器位置的访问</td>
</tr>
<tr>
<td>REPLICATION SLAVE</td>
<td>由复制从属使用</td>
</tr>
<tr>
<td>SELECT</td>
<td>使用SELECT</td>
</tr>
<tr>
<td>SHOW DATABASES</td>
<td>使用SHOW DATABASES</td>
</tr>
<tr>
<td>SHOW VIEW</td>
<td>使用SHOW CREATE VIEW</td>
</tr>
<tr>
<td>SHUTDOWN</td>
<td>使用mysqladmin shutdown（用来关闭MySQL）</td>
</tr>
<tr>
<td>SUPER</td>
<td>使用CHANGE MASTER、KILL、LOGS、PURGE、MASTER和SET GLOBAL。还允许mysqladmin调试登录</td>
</tr>
<tr>
<td>UPDATE</td>
<td>使用UPDATE</td>
</tr>
<tr>
<td>USAGE</td>
<td>无访问权限</td>
</tr>
</tbody>
</table>
<h1 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h1><h2 id="查询语法"><a href="#查询语法" class="headerlink" title="查询语法"></a>查询语法</h2><p>》 通过<code>DISTINCT</code>关键字，将SELECT检索的结果，只返回不同值</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT [DISTINCT] &lt;column-name&gt;,&lt;column-name&gt;,... FROM &lt;table-name&gt; </span><br><span class="line">[WHERE 条件]</span><br><span class="line">[GROUP BY]</span><br><span class="line">[HAVING]</span><br><span class="line">[ORDER BY]</span><br><span class="line">[LIMIT]</span><br></pre></td></tr></table></figure></div>
<h1 id="查询原理"><a href="#查询原理" class="headerlink" title="查询原理"></a>查询原理</h1><p>》 单表查询原理</p>
<ul>
<li>根据WHERE条件过滤表中的记录，形成中间表（用户不可见）</li>
<li>根据SELECT的选择列从中间表中选择相应的列进行返回最终结果</li>
</ul>
<p>》 两表连接查询</p>
<ul>
<li>对两表求积（笛卡儿积）并用ON条件和连接类型进行过滤形成中间表</li>
<li>根据WHERE条件过滤中间表记录</li>
<li>根据SELECT的选择列从中间表中选择相应的列进行返回最终结果</li>
</ul>
<p>》 多表连接查询</p>
<ul>
<li>先对第一个第二个表按照两表连接查询</li>
<li>查询结果和第三个表做连接，以此n+,知道所有表结束</li>
<li>最终形成一个中间表</li>
<li>根据WHERE条件过滤表中的记录，形成中间表（用户不可见）</li>
<li>根据SELECT的选择列从中间表中选择相应的列进行返回最终结果</li>
</ul>
<h2 id="别名查询"><a href="#别名查询" class="headerlink" title="别名查询"></a>别名查询</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单列别名</span></span><br><span class="line">SELECT  &lt;column-name&gt;,&lt;column-name&gt; AS &lt;alias-name&gt;,... FROM &lt;table-name&gt; </span><br><span class="line"><span class="comment">//多列别名</span></span><br><span class="line">SELECT  (&lt;column-name&gt;,&lt;column-name&gt;) AS &lt;alias-name&gt;,... FROM &lt;table-name&gt; </span><br><span class="line"><span class="comment">//表别名</span></span><br><span class="line">SELECT  &lt;column-name&gt;,&lt;column-name&gt; ,... FROM &lt;table-name&gt; AS &lt;alias-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="运算查询"><a href="#运算查询" class="headerlink" title="运算查询"></a>运算查询</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT  &lt;column-name&gt;*10, &lt;column-name&gt;+20 AS &lt;alias-name&gt; ,... FROM &lt;table-name&gt;</span><br></pre></td></tr></table></figure></div>
<h2 id="SELECT-子句"><a href="#SELECT-子句" class="headerlink" title="SELECT 子句"></a>SELECT 子句</h2><h3 id="SELECT-子句顺序"><a href="#SELECT-子句顺序" class="headerlink" title="SELECT 子句顺序"></a>SELECT 子句顺序</h3><table>
<thead>
<tr>
<th>子句</th>
<th>说明</th>
<th>是否必须使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>SELECT</td>
<td>要返回的列或表达式</td>
<td>是</td>
</tr>
<tr>
<td>FROM</td>
<td>从中检索数据的表</td>
<td>仅在从表选择数据时使用</td>
</tr>
<tr>
<td>WHERE</td>
<td>行级过滤</td>
<td>否</td>
</tr>
<tr>
<td>GROUP BY</td>
<td>分组说明</td>
<td>仅在安祖计算聚焦时使用</td>
</tr>
<tr>
<td>HAVING</td>
<td>组级过滤</td>
<td>否</td>
</tr>
<tr>
<td>ORDER BY</td>
<td>输出排序顺序</td>
<td>否</td>
</tr>
<tr>
<td>LIMIT</td>
<td>要检索的行数</td>
<td>否</td>
</tr>
</tbody>
</table>
<h3 id="WHERE（位于ORDER-BY之前）"><a href="#WHERE（位于ORDER-BY之前）" class="headerlink" title="WHERE（位于ORDER BY之前）"></a>WHERE（位于ORDER BY之前）</h3><h4 id="指定单个搜索条件"><a href="#指定单个搜索条件" class="headerlink" title="指定单个搜索条件"></a>指定单个搜索条件</h4><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//WHERE 条件,条件由&lt;column-name&gt;、运算符、数据组成</span></span><br><span class="line">WHERE &lt;column-name&gt; 运算符 数据</span><br></pre></td></tr></table></figure></div>
<h4 id="WHERE-可用条件"><a href="#WHERE-可用条件" class="headerlink" title="WHERE 可用条件"></a>WHERE 可用条件</h4><p>》 比较运算符：</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>&gt;, &lt;, &lt;=, &gt;=, =, &lt;&gt;</td>
<td>大于、小于、小于等于、大于等于、等于，不等于</td>
</tr>
<tr>
<td>BETWEEN…AND</td>
<td>某区间的值（包含头尾）</td>
</tr>
<tr>
<td>IN()</td>
<td>指定IN()中的特定值，如IN(100,200)</td>
</tr>
<tr>
<td>LIKE ‘’</td>
<td>模糊查询</td>
</tr>
<tr>
<td>IS NULL/IS NOT NULL</td>
<td>判空</td>
</tr>
</tbody>
</table>
<p>》 逻辑运算符：</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>AND</td>
<td>多条件同时成立</td>
</tr>
<tr>
<td>OR</td>
<td>多条件任一成立,优先级低于AND，可用()来提升优先级</td>
</tr>
<tr>
<td>NOT</td>
<td>否定其后的条,mysql仅支持对IN、BETWEEN、EXISTS句子取反</td>
</tr>
</tbody>
</table>
<p>》 注：</p>
<ul>
<li>字符串类型用单引号’’括起来</li>
<li>值与字符串类型比较时，字符串会转为值。系统采取截取方式，截取字符串前面的数值，如02asda那么就是02,而对于字母开头的,就直接转为0。</li>
</ul>
<h4 id="通配操作符LIKE"><a href="#通配操作符LIKE" class="headerlink" title="通配操作符LIKE"></a>通配操作符LIKE</h4><p>》 <code>%</code> 通配符：匹配0、1或多个字符</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//找出所有以jet开头的数据</span></span><br><span class="line">WHERE prod_name LIKE <span class="string">'jet%'</span>;</span><br></pre></td></tr></table></figure></div>
<p>》<code>_</code> 通配符：匹配单个字符</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将会匹配1 ton anvil,而不会匹配 .5 ton anvi </span></span><br><span class="line">WHERE prod_name LIKE <span class="string">'_ ton  anvil'</span></span><br></pre></td></tr></table></figure></div>
<p>》注: </p>
<ul>
<li>尾空格会干扰通配符匹配。如anvil后多了一个或多个空格。”%anvil “将会不匹配到它，解决方法是在后面也加一个%. %anvil% 或使用函数去除。</li>
<li>%无法匹配NULL值，即”LIKE ‘%’”不会匹配到值NULL的行。</li>
<li>不要过度使用通配符，能使用其他操作符就使用其他操作符</li>
<li>通配符置于开始，搜索最慢（即尽量不要使用在开头）</li>
</ul>
<h4 id="正则表达式REGEXP"><a href="#正则表达式REGEXP" class="headerlink" title="正则表达式REGEXP"></a>正则表达式REGEXP</h4><p>》 MySQL用WHERE子句对正则表达式提供了支持,其用法与LIKE相似</p>
<p>进行OR匹配：使用 “|”</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将匹配到包含1000或2000的行,两个以上则1000|2000|3000|</span></span><br><span class="line"> WHERE prod_name REGEXP <span class="string">'1000|2000'</span></span><br></pre></td></tr></table></figure></div>
<p>》 匹配几个字符之一,使用” [] “</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//[123]表示匹配1或2或3，是[1|2|3]的缩写，[^123]将匹配除这几个字符外的任何数据。[]相当于一个字符集合。</span></span><br><span class="line">WHERE prod_name REGEXP <span class="string">'[123] ton'</span></span><br></pre></td></tr></table></figure></div>
<p>》 匹配范围  </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[a-z][A-Z]：匹配字母  </span><br><span class="line"></span><br><span class="line">[0-9]: 匹配数字</span><br><span class="line"></span><br><span class="line">[a-z0-9]：组合使用</span><br></pre></td></tr></table></figure></div>
<p>》匹配特殊字符,使用<code>\ \</code>  </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">如想要匹配点&quot;.“，则REGEXP &apos; \ \ . &apos;,也可以用来引用元字符，如  </span><br><span class="line"> \ \ f：换页  </span><br><span class="line"> \ \ n：换行  </span><br><span class="line"> \ \ r：回车  </span><br><span class="line"> \ \ t：制表  </span><br><span class="line"> \ \ v：纵向制表</span><br></pre></td></tr></table></figure></div>
<p>》 匹配字符类,即自定义的字符集称为字符类  </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[:alnum:]：任意字符和字母（同[a-zA-Z0-9]）  </span><br><span class="line">[:alpha:]：任意字符(同[a-zA-Z])  </span><br><span class="line">[:blank:]：空表和制表(同[\\t])  </span><br><span class="line">[:cntrl:]：ASCII控制符(ASCII 0到31和127)  </span><br><span class="line">[:digit:]：任意数字（同[0-9]）  </span><br><span class="line">[:graph:]：任意可打印字符，与[:print:]相同，但不包括空格  </span><br><span class="line">[:lower:]：任意小写字母(同[a-z])  </span><br><span class="line">[:print:]：任意可打印字符，与[:graph:]相同，且包括空格  </span><br><span class="line">[:punct:]：即不再[:alnum:]也不再[:cntrl:]中的任意字符  </span><br><span class="line">[:upper:]：任意大写字母（同[A-Z]）  </span><br><span class="line">[:xdigit:]：任意十六进制数字(同[a-fA-F0-9])</span><br></pre></td></tr></table></figure></div>
<p>》 匹配多个实例，通过正则表达式重复元字符完成  </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">如[0-9][0-9][0-9][0-9]相当于[0-9]&#123;4&#125;相当于[:digit:]&#123;4&#125;  </span><br><span class="line">&quot;*&quot;：0个或1个或多个  </span><br><span class="line">&quot;+&quot;：1个或多个，相当于&#123;1,&#125;  </span><br><span class="line">&quot;?&quot;：0个或一个，相当于&#123;0,1&#125;  </span><br><span class="line">&quot;&#123;n&#125;&quot;：n个  </span><br><span class="line">&quot;&#123;n,&#125;&quot;：n个或多于n个  </span><br><span class="line">&quot;&#123;n,m&#125;&quot;：n~m个</span><br></pre></td></tr></table></figure></div>
<p>》 定位符，匹配特定位置的文本  </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">如^[0-9\\.]，匹配以数字或小数点开始。(注意^的位置，如果是在集合里[^0-9\\.],则是否定该集合)  </span><br><span class="line">&quot;^&quot;：文本的开始  </span><br><span class="line">&quot;$&quot;：文本的结尾  </span><br><span class="line">[[:&lt;:]]：词的开始  </span><br><span class="line">[[::]]：词的结尾</span><br></pre></td></tr></table></figure></div>
<h4 id="LIKE与RNGEXP的不同"><a href="#LIKE与RNGEXP的不同" class="headerlink" title="LIKE与RNGEXP的不同"></a>LIKE与RNGEXP的不同</h4><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//匹配整个列的值，即要完全匹配</span><br><span class="line">LIKE &apos;1000&apos;</span><br><span class="line">//该值只要在列中出现，则匹配</span><br><span class="line">REGEXP &apos;1000&apos;</span><br><span class="line">//想要匹配整个列</span><br><span class="line">REGEXP &apos;^1000$&apos;</span><br></pre></td></tr></table></figure></div>
<h3 id="GROUP-BY-WHERE子句之后，ORDER-BY之前"><a href="#GROUP-BY-WHERE子句之后，ORDER-BY之前" class="headerlink" title="GROUP BY(WHERE子句之后，ORDER BY之前)"></a>GROUP BY(WHERE子句之后，ORDER BY之前)</h3><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRPUP BY &lt;column-name&gt;</span><br></pre></td></tr></table></figure></div>
<p>》 创建分组,通过GROUP BY将数据按vend_id分组后，COUNT（*）将会对分组后的数据分别计算一次。</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT vend_id, COUNT(*) AS num_prods</span><br><span class="line">FROM products</span><br><span class="line">GOURP BY vend_id</span><br></pre></td></tr></table></figure></div>
<h3 id="HAVING"><a href="#HAVING" class="headerlink" title="HAVING"></a>HAVING</h3><p>》 HAVING</p>
<ol>
<li>WHERE是过滤行，而HAVING是过滤分组</li>
<li>WHERE是在分组前过滤，而HAVING是在分组后过滤</li>
<li>HAVING支持所有WHERE操作符</li>
</ol>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//过滤分组,按cust_id分组，然后过滤出行数大于等于2组。</span></span><br><span class="line">SELECT cust_id, COUNT(*) AS orders</span><br><span class="line">FROM orders</span><br><span class="line">GROUP BY cust_id</span><br><span class="line"><span class="function">HAVING <span class="title">count</span><span class="params">(*)</span> </span>= <span class="number">2</span></span><br></pre></td></tr></table></figure></div>
<h3 id="ORDER-BY（位于-WHERE-之后）"><a href="#ORDER-BY（位于-WHERE-之后）" class="headerlink" title="ORDER BY（位于 WHERE 之后）"></a>ORDER BY（位于 WHERE 之后）</h3><p>》 ORDER BY：</p>
<ul>
<li>DESC:降序  </li>
<li>ASC:升序(默认)  </li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ORDER BY &lt;column-name&gt; [DESC/ASC]</span><br><span class="line"><span class="comment">//按多个列进行排序（先根据列1排，在根据列2排）</span></span><br><span class="line">ORDER BY &lt;column-name&gt;,&lt;column-name2&gt; [DESC/ASC]</span><br><span class="line"><span class="comment">//指定排序方向的多个列排序，DESC/ASC只应用到直接位于其前面的列名</span></span><br><span class="line">ORDER BY &lt;column-name&gt; [DESC/ASC],&lt;column-name2&gt; [DESC/ASC]</span><br></pre></td></tr></table></figure></div>
<p>》 ORDER BY 子句中使用的列通常为要显示的列，但用非检索的列排序数据也是完全合法的</p>
<h3 id="LIMIT"><a href="#LIMIT" class="headerlink" title="LIMIT"></a>LIMIT</h3><p>》 MySQL特有的语法，实现了物理分页</p>
<p>》 物理分页：直接在数据库中进行分页，最终只返回分页后的数据</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//offset:起始位置</span></span><br><span class="line"><span class="comment">//rows:每页多少行</span></span><br><span class="line">SELECT * FROM &lt;table-name&gt; LIMIT [offset,] rows;</span><br><span class="line"><span class="comment">//另一种写法</span></span><br><span class="line">SELECT * FROM &lt;table-name&gt; LIMIT rows OFFSET [offset];</span><br></pre></td></tr></table></figure></div>
<p>》 示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从第2位置开始返回3行(（第一行为0)：</span></span><br><span class="line">LIMIT <span class="number">2</span>,<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>》 又叫<strong>内部查询</strong>，即嵌套在其他查询中的查询；包含内部查询的被成为外部查询</p>
<h3 id="利用子查询过滤"><a href="#利用子查询过滤" class="headerlink" title="利用子查询过滤"></a>利用子查询过滤</h3><p>》 将一条SELECT语句返回的结果用于另一条SELECT语句的WHERE子句</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT cust_id</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_num IN (SELECT order_num </span><br><span class="line">		FROM orderitems </span><br><span class="line">		WHERE prod_id = &apos;TNT2&apos;)</span><br></pre></td></tr></table></figure></div>
<h3 id="作为计算字段使用子查询"><a href="#作为计算字段使用子查询" class="headerlink" title="作为计算字段使用子查询"></a>作为计算字段使用子查询</h3><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT cust_name,</span><br><span class="line">		cust_state.</span><br><span class="line">		(SELECT COUNT(*)</span><br><span class="line">		FROM orders</span><br><span class="line">		WHERE orders.cust_id = customers.cust_id) AS orders</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY cust_name</span><br></pre></td></tr></table></figure></div>
<h1 id="组合查询-UNION"><a href="#组合查询-UNION" class="headerlink" title="组合查询 UNION"></a>组合查询 UNION</h1><p>》 使用组合查询的两种情况</p>
<ul>
<li>在单个查询中从不同的表返回类似结构的数据</li>
<li>对单个表执行多个查询，按单个查询返回数据</li>
</ul>
<p>》  创建组合查询:如，通过UNION连接两个SELECT</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT vend_id, prod_id, prod_price</span><br><span class="line">FROM products</span><br><span class="line">WHERE prod_price &lt;=5</span><br><span class="line">UNION</span><br><span class="line">SELECT vend_id, prod_id, prod_price</span><br><span class="line">FROM products</span><br><span class="line">WHERE vend_id IN(1001, 1002)</span><br></pre></td></tr></table></figure></div>
<p>》 UNION规则</p>
<ul>
<li>UNION必须由两条或以上SELECT语句组成，语句之间用UNION分割</li>
<li>UNION中的每个查询必须包含相同列、表达式或聚集函数（次序可以不同）</li>
<li>列数据列下必须兼容。（可不必完全相同，但必须隐含转换的类型）</li>
</ul>
<p>》 包含或取消重复的行</p>
<ul>
<li>UNION：自动去除重复的行</li>
<li>UNION ALLL：返回全部的行</li>
</ul>
<p>》 对组合查询结果排序： 在最后一个SELECT后面加ORDER BY，将排序所有SELECT语句返回的结果。</p>
<h1 id="全文本搜索"><a href="#全文本搜索" class="headerlink" title="全文本搜索"></a>全文本搜索</h1><p>》 搜索text数据（MyISAM支持，InnoDB不支持）</p>
<p>》 启用全文本搜索FULLTEXT</p>
<ul>
<li>Mysql会根据FULLTEXT（）的指示对它进行索引，自动维护该索引。在增加、更新或删除行时，索引随之自动跟新。</li>
<li>可以在创建表时指定FULLTEXT（不推荐），也可以稍后指定。</li>
<li>先导入数据，在定义FULLTEXT，有助于更快导入索引（更新索引需要时间）</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE productnotes</span><br><span class="line">(</span><br><span class="line">	note_id int NOT NULL ATUO_INCREMENT,</span><br><span class="line">	prod_id char(10) NOT NULL,</span><br><span class="line">	note_date datetime NOT NULL,</span><br><span class="line">	note_nect text NULL,</span><br><span class="line">	PRIMARY KEY(note_id),</span><br><span class="line">	FULLTEXT(note_text)</span><br><span class="line">) ENGINE = MyISAM</span><br></pre></td></tr></table></figure></div>
<p>》 进行全文本搜索Match()和Against()</p>
<ul>
<li>Match()指定所搜的列</li>
<li>Against()指定搜索表达式</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如，将会搜索包含rabbit的文本,不区分大小写</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span><span class="params">(<span class="string">'rabbit'</span>)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 与LIKE的区别</p>
<ul>
<li>LIKE以不特别有用的顺序返回数据</li>
<li>全文本搜索返回以文本匹配的良好程度排序的顺序(如rabbit作为第3个词的行等级比作为第20个词的行高)</li>
</ul>
<p>》 查询扩展WITH QUERY EXPANSION</p>
<ul>
<li>用来放宽返回的全文本搜索结果的范围</li>
<li>首先进行基本的全文本搜索，找出匹配的行，</li>
<li>其次，检查这些匹配行并选择所有有用的词，<br>最后，再次使用有用的词进行一次全文本上搜索。</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line">WHERE Match(note_text) Against(&apos;anvils&apos; WITH QUERY EXPANSION)</span><br></pre></td></tr></table></figure></div>
<p>》 布尔文本搜索IN BOLEAN MODE，可以提供内容细节</p>
<ul>
<li>要匹配的词</li>
<li>要排斥的词（如果某行包含这个词，则不反回改行。即使包含匹配的词）</li>
<li>排列提示（指定某些词比其他词更重要）</li>
<li>表达式分组</li>
<li>另外一些内容</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//匹配heavy,但排除任何以rope开始的词或行</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span> <span class="params">(<span class="string">'heavy -rope*'</span> IN BOOLEAN MODE)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 全文本布尔操作符</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+：包含，词必须存在</span><br><span class="line">-：排除，词必须不出现</span><br><span class="line">：包含，而且增加等级</span><br><span class="line">&lt;：包含，而且减少等级</span><br><span class="line">()：把词组成子表达式（允许子表达式作为一个组被包含、排除、排列）</span><br><span class="line">~：取消一个词的排序值</span><br><span class="line">*：词尾通配符</span><br><span class="line">&quot;&quot;：定义一个短语（与单个词的列表不一样，它匹配整个短语以便包含或排除这个短语）</span><br></pre></td></tr></table></figure></div>
<p>》 示例1</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//包含rabbit和bait的行</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span><span class="params">(<span class="string">'+rabbit +bait'</span> IN BOOLEAN MODE)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 示例2:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//至少包含rabbit和bait其中一个的行</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span><span class="params">(<span class="string">'rabbit bait'</span> IN BOOLEAN MODE)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 示例3:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//匹配短语rabbit bait而不是匹配两个词</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span><span class="params">(<span class="string">'"rabbit bait"'</span> IN BOOLEAN MODE)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 示例4:</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//至少包含rabbit和bait其中一个的行，增加rabbit的等级，降低bait的等级</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span><span class="params">(<span class="string">'rabbit &lt;bait'</span> IN BOOLEAN MODE)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 示例5</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//至少包含safe 和combination其中一个的行，降低combination的等级</span></span><br><span class="line"></span><br><span class="line">SELECT note_text</span><br><span class="line">FROM productnotes</span><br><span class="line"><span class="function">WHERE <span class="title">Match</span><span class="params">(note_text)</span> <span class="title">Against</span><span class="params">(<span class="string">'+safe +(&lt;combination)'</span> IN BOOLEAN MODE)</span></span></span><br></pre></td></tr></table></figure></div>
<p>》 全文本搜索使用说明</p>
<ul>
<li>在索引全文本数据时，短词被忽略且从索引中排除。（短词：3个或3个一下字符的词）</li>
<li>MySQL带有一个内建的非用词列表，这些词在索引时被忽略</li>
<li>高频词汇会被当做非用词（一个词出现在50%以上的行,该规则不用于IN BOOLEAN MODE）</li>
<li>如果表中的行数少于3行，则全文本搜索不反回结果(要么没有，要么至少出现在50%行中)</li>
<li>忽略此种的单引号。如don’t索引为dont</li>
<li>不具有此分隔符的语言不能恰当地返回全文本搜索结果（汉语、日语）</li>
<li>仅在MyISAM引擎中支持全文本搜索</li>
</ul>
<h1 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h1><h2 id="插入完整的行"><a href="#插入完整的行" class="headerlink" title="插入完整的行"></a>插入完整的行</h2><p>》 插入规则：</p>
<ul>
<li>列可以不按次序，但值与列次序一一对应，没有值的使用NULL值</li>
<li>可以省略某些列，但该列必须允许NULL值或在表定义中给出了默认值</li>
<li>提高性能：INSERT INTO耗时，且可能降低等待处理的SELECT语句的性能。如果数据检索是最重要的，可以使用INSERT LOW_PRIORITY INTO来降低INSERT语句的优先级(同样适用UPDATE和DELETE)</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &lt;table-name&gt;(</span><br><span class="line">	&lt;column-name&gt;,</span><br><span class="line">	&lt;column-name2&gt;,</span><br><span class="line">	&lt;column-name3&gt;，</span><br><span class="line">	...</span><br><span class="line">	) VALUES(</span><br><span class="line">		&lt;value&gt;,</span><br><span class="line">		&lt;value&gt;,</span><br><span class="line">		&lt;value&gt;,</span><br><span class="line">		...</span><br><span class="line">	)</span><br></pre></td></tr></table></figure></div>
<h2 id="插入多个行"><a href="#插入多个行" class="headerlink" title="插入多个行"></a>插入多个行</h2><p>》 每组值用一堆圆括号括起来，用逗号分隔</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &lt;table-name&gt;(</span><br><span class="line">	&lt;column-name&gt;,</span><br><span class="line">	&lt;column-name2&gt;,</span><br><span class="line">	&lt;column-name3&gt;，</span><br><span class="line">	...</span><br><span class="line">)</span><br><span class="line">VALUES(</span><br><span class="line">	&lt;value&gt;,</span><br><span class="line">	&lt;value&gt;,</span><br><span class="line">	&lt;value&gt;,</span><br><span class="line">	...</span><br><span class="line">),</span><br><span class="line">(</span><br><span class="line">	&lt;value&gt;,</span><br><span class="line">	&lt;value&gt;,</span><br><span class="line">	&lt;value&gt;,</span><br><span class="line">	...</span><br><span class="line">),</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>
<h2 id="插入检索出的数据"><a href="#插入检索出的数据" class="headerlink" title="插入检索出的数据:"></a>插入检索出的数据:</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO &lt;table-name&gt; (</span><br><span class="line">	&lt;column-name&gt;,</span><br><span class="line">	&lt;column-name2&gt;,</span><br><span class="line">	&lt;column-name3&gt;，</span><br><span class="line">	...</span><br><span class="line">) SELECT  * FROM &lt;table&gt;</span><br></pre></td></tr></table></figure></div>
<h1 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h1><p>》 <strong>使用前特别注意！：  不要省略WHERE子句，因为稍不注意，可能更新表中所有行</strong></p>
<h2 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">UPDATE &lt;table-name&gt; SET </span><br><span class="line">    &lt;column-name&gt;=&lt;value&gt;,</span><br><span class="line">    &lt;column-name2&gt;=&lt;value2&gt;,</span><br><span class="line">    &lt;column-name3&gt;=&lt;value3&gt;,</span><br><span class="line">    &lt;column-name4&gt;=&lt;value4&gt;,</span><br><span class="line">    ...</span><br><span class="line">    WHERE 条件;</span><br><span class="line"></span><br><span class="line"><span class="comment">//忽略错误，继续更新(UPDATE在更新时如果出现错误，整个操作都会被取消)</span></span><br><span class="line">UPDATE INGNORE &lt;table-name&gt; SET </span><br><span class="line">    &lt;column-name&gt;=&lt;value&gt;,</span><br><span class="line">    &lt;column-name2&gt;=&lt;value2&gt;,</span><br><span class="line">    &lt;column-name3&gt;=&lt;value3&gt;,</span><br><span class="line">    &lt;column-name4&gt;=&lt;value4&gt;,</span><br><span class="line">    ...</span><br><span class="line">    WHERE 条件;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除某个列的值,可以将其设置为NULL</span></span><br><span class="line">&lt;column-name&gt;=NULL</span><br></pre></td></tr></table></figure></div>
<h1 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h1><p><strong>使用前特别注意！！！</strong></p>
<ul>
<li>不要省略WHERE子句，因为稍不注意，可能删除表中所有行</li>
<li>DELETE删除的是整行。想要删除列，还是要用UPDATE</li>
</ul>
<h2 id="删除行"><a href="#删除行" class="headerlink" title="删除行"></a>删除行</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM &lt;table-name&gt; WHERE 条件;</span><br><span class="line"><span class="comment">//删除所有行</span></span><br><span class="line">DELETE FROM &lt;table-name&gt;;</span><br></pre></td></tr></table></figure></div>
<h2 id="更快的全部删除"><a href="#更快的全部删除" class="headerlink" title="更快的全部删除"></a>更快的全部删除</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TRUNCATE TABLE &lt;table-name&gt;</span><br></pre></td></tr></table></figure></div>
<p>》 区别：</p>
<ul>
<li><p>TRUNCATE实际上是删除原表重新创建，而不是逐行删除,清空AUTO_INCREMENT记录数</p>
</li>
<li><p>DELETE是一条一条删除，不清空AUTO_INCREMENT记录数</p>
</li>
</ul>
<h2 id="更新和删除所遵循的习惯"><a href="#更新和删除所遵循的习惯" class="headerlink" title="更新和删除所遵循的习惯"></a>更新和删除所遵循的习惯</h2><p>》 规则如下：</p>
<ul>
<li>除非打算更新和删除所有行。否则不要用不带WHERE的UPDATE、DELETE语句</li>
<li>保证每个表都有逐渐，尽可能像`WHERE子句那样使用它</li>
<li>对UPDATE和DELETE语句使用WHERE子句前，先使用SELECT进行测试，保证正确的记录。</li>
<li>使用强制实施完整性的数据库，这样MySQL将不允许删除具有与其他表相关联的数据的行。</li>
<li>MySQL没有撤销按钮，所以要小心使用UPDATE和DELETE</li>
</ul>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="常用的文本处理函数"><a href="#常用的文本处理函数" class="headerlink" title="常用的文本处理函数"></a>常用的文本处理函数</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Concat(): 拼接字段</span><br><span class="line">Left()：返回串左边的字符</span><br><span class="line">Length()：返回串的长度</span><br><span class="line">Lecate()：找出串的一个子串</span><br><span class="line">Lower()：将串转换为小写</span><br><span class="line">Upper()：将串转换为大写</span><br><span class="line">LTrim()：去掉串左边的空格</span><br><span class="line">RTrim()：去掉串右边的空格</span><br><span class="line">Trim()：去掉串两边的空格</span><br><span class="line">Right()：返回串右边的字符</span><br><span class="line">Soundex()：返回串的SOUNDEX值</span><br><span class="line">SubString()：返回子串的字符</span><br></pre></td></tr></table></figure></div>
<h2 id="常用时间和日期处理函数"><a href="#常用时间和日期处理函数" class="headerlink" title="常用时间和日期处理函数"></a>常用时间和日期处理函数</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">AddDate()：增加一个日期（天、周等）</span><br><span class="line">AddTime()：增加一个时间（时、分等）</span><br><span class="line">CurDate()：返回当前日期</span><br><span class="line">CurTime()：返回当前时间</span><br><span class="line">Date()：返回日期时间的日期部分</span><br><span class="line">DateDiff()：计算两个日期之差</span><br><span class="line">Date_Add()：高度灵活的日期运算函数</span><br><span class="line">Date_Format()：返回一个格式化的日期或时间串</span><br><span class="line">Day()：返回一个日期的天数部分</span><br><span class="line">DayOfWeek()：对于一个日期，返回对应的星期几</span><br><span class="line">Hour()：返回一个时间的小时部分</span><br><span class="line">Minute()：返回一个时间的分钟部分</span><br><span class="line">Month()：返回一个日期的月份部分</span><br><span class="line">Now()：返回当前日期和时间</span><br><span class="line">Second()：返回一个时间的秒部分</span><br><span class="line">Time()：返回一个日期时间的时间部分</span><br><span class="line">Year()：返回一个日期的年份部分</span><br></pre></td></tr></table></figure></div>
<p>》 检索日期</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//假设order_date数据类型datetime，其格式为2005-09-01 21:21:53,所以需要使用Date()来提取order_date的日期部分</span></span><br><span class="line">SELECT cust_id, order_num</span><br><span class="line">FROM orders</span><br><span class="line"><span class="function">WHERE <span class="title">Date</span><span class="params">(order_date)</span> </span>= <span class="string">'2005-09-01'</span></span><br></pre></td></tr></table></figure></div>
<p>》 注意： 日期格式必须为 <code>yyyy-mm-dd</code> ,如2005年9月1日，则- 2005-09-01</p>
<h2 id="数值处理函数"><a href="#数值处理函数" class="headerlink" title="数值处理函数"></a>数值处理函数</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Abs()：返回一个数的绝对值</span><br><span class="line">Cos()：返回一个角度的余弦</span><br><span class="line">Exp()：返回一个数的指数值</span><br><span class="line">Mod()：返回一个除操作的余数</span><br><span class="line">Pi()：返回圆周率</span><br><span class="line">Rand()：返回一个随机数</span><br><span class="line">Sin()：返回一个角度的正弦</span><br><span class="line">Sqrt()：返回一个数的平方根</span><br><span class="line">Tan()：返回一个角度的正切</span><br></pre></td></tr></table></figure></div>
<h2 id="聚焦函数"><a href="#聚焦函数" class="headerlink" title="聚焦函数"></a>聚焦函数</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AVG()函数：返回某列的平均值(忽略值为NULL的行)  </span><br><span class="line">COUNT(*):对表中行的数据进行计算，包含空值NULL </span><br><span class="line">COUNT(column):对特定列中具有值的行进行计数，忽略NULL值。  </span><br><span class="line">MAX()函数：返回某列的最大值(忽略NULL值)</span><br><span class="line">MIN()函数：返回某列的最小值（与MAX()相反）</span><br><span class="line">SUM()：返回某列值之和（忽略NULL值）,如，计算总金额时使用</span><br></pre></td></tr></table></figure></div>
<h1 id="字符集"><a href="#字符集" class="headerlink" title="字符集"></a>字符集</h1><p>》 重要术语</p>
<ul>
<li>字符集：字母和符号的集合</li>
<li>编码：某个字符集成员的内部表示</li>
<li>校对：规定字符如何比较的指令</li>
</ul>
<h2 id="字符集相关操作"><a href="#字符集相关操作" class="headerlink" title="字符集相关操作"></a>字符集相关操作</h2><p>》 显示所有可用的字符集以及每个字符集的描述和默认校对</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CHARACTER SET</span><br></pre></td></tr></table></figure></div>
<p>》 查看Mysql支持的校对完整列表</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW COLLATION</span><br></pre></td></tr></table></figure></div>
<p>》 查看数据库默认的字符集</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &apos;character%&apos;</span><br></pre></td></tr></table></figure></div>
<p>》 查看数据库默认的校对：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &apos;collation%&apos;</span><br></pre></td></tr></table></figure></div>
<p>》 在创建表时指定字符集和校对</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE mytable(</span><br><span class="line">	column1 INT,</span><br><span class="line">	column2 VARCHAR(10)</span><br><span class="line">) DEFAULT CHARACTER SET hebrew</span><br><span class="line">   COLLATE hebrew_general_ci;</span><br></pre></td></tr></table></figure></div>
<h2 id="MySQL使用字符集和校对规则"><a href="#MySQL使用字符集和校对规则" class="headerlink" title="MySQL使用字符集和校对规则"></a>MySQL使用字符集和校对规则</h2><ul>
<li>明确指定两个</li>
<li>只指定CHARACTER SET，则使用此字符集及其默认的校对</li>
<li>都不知道，则使用数据库默认</li>
</ul>
<h2 id="列级别的字符和校对"><a href="#列级别的字符和校对" class="headerlink" title="列级别的字符和校对"></a>列级别的字符和校对</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CRETE TABLE mytable(</span><br><span class="line">column3 VARCHAR(10) CHARACTER SET latin1 COLLATE latin1_general_ci</span><br><span class="line">) DEFAULT CHARACTER ser HEBREW</span><br><span class="line">  COLLATRE hebrew_general_ci</span><br><span class="line">``</span><br></pre></td></tr></table></figure></div>
<h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><h2 id="常用数据类型"><a href="#常用数据类型" class="headerlink" title="常用数据类型"></a>常用数据类型</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR</td>
<td>1～255个字符的定长串。它的长度必须在创建时指定，否则MySQL假定为CHAR(1)</td>
</tr>
<tr>
<td>ENUM</td>
<td>接受最多64 K个串组成的一个预定义集合的某个串</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>与TEXT相同，但最大长度为4 GB</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>与TEXT相同，但最大长度为16 K</td>
</tr>
<tr>
<td>SET</td>
<td>接受最多64个串组成的一个预定义集合的零个或多个串</td>
</tr>
<tr>
<td>TEXT</td>
<td>最大长度为64 K的变长文本</td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>与TEXT相同，但最大长度为255字节</td>
</tr>
<tr>
<td>VARCHAR</td>
<td>长度可变，最多不超过255字节。如果在创建时指定为VARCHAR(n)m则可存储0到n个字符的变长串（其中n≤255）</td>
</tr>
</tbody>
</table>
<h2 id="数值数据类型"><a href="#数值数据类型" class="headerlink" title="数值数据类型"></a>数值数据类型</h2><p>》 MySQL中没有专门存储货币的数据类型，一般情况下使用</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DECIMAL(8, 2)</span><br></pre></td></tr></table></figure></div>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIT</td>
<td>位字段，1～64位。（在MySQL 5之前，BIT在功能上等价于TINYINT</td>
</tr>
<tr>
<td>BIGINT</td>
<td>整数值，支持9223372036854775808～9223372036854775807（如果是UNSIGNED，为0～18446744073709551615）的数</td>
</tr>
<tr>
<td>BOOLEAN（或BOOL）</td>
<td>布尔标志，或者为0或者为1，主要用于开/关（on/off）标志</td>
</tr>
<tr>
<td>DECIMAL（或DEC）</td>
<td>精度可变的浮点值</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>双精度浮点值</td>
</tr>
<tr>
<td>FLOAT</td>
<td>单精度浮点值</td>
</tr>
<tr>
<td>INT（或INTEGER）</td>
<td>整数值，支持2147483648～2147483647（如果是UNSIGNED，为0～4294967295）的数</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>整数值，支持8388608～8388607（如果是UNSIGNED，为0～16777215）的数</td>
</tr>
<tr>
<td>REAL</td>
<td>4字节的浮点值</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>整数值，支持32768～32767（如果是UNSIGNED，为0～65535）的数</td>
</tr>
<tr>
<td>TINYINT</td>
<td>整数值，支持128～127（如果为UNSIGNED，为0～255）的数</td>
</tr>
</tbody>
</table>
<h2 id="日期和时间数据类型"><a href="#日期和时间数据类型" class="headerlink" title="日期和时间数据类型"></a>日期和时间数据类型</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody>
<tr>
<td>DATE</td>
<td>表示1000-01-01～9999-12-31的日期，格式为YYYY-MM-DD</td>
</tr>
<tr>
<td>DATETIME</td>
<td>DATE和TIME的组合</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>功能和DATETIME相同（但范围较小）</td>
</tr>
<tr>
<td>TIME</td>
<td>格式为HH:MM:SS</td>
</tr>
<tr>
<td>YEAR</td>
<td>用2位数字表示，范围是70（1970年）～69（2069年），用4位数字表示，范围是1901年～2155年</td>
</tr>
</tbody>
</table>
<h2 id="二进制数据类型"><a href="#二进制数据类型" class="headerlink" title="二进制数据类型"></a>二进制数据类型</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>说 明</th>
</tr>
</thead>
<tbody>
<tr>
<td>BLOB</td>
<td>Blob最大长度为64 KB</td>
</tr>
<tr>
<td>MEDIUMBLOB</td>
<td>Blob最大长度为16 MB</td>
</tr>
<tr>
<td>LONGBLOB</td>
<td>Blob最大长度为4 GB</td>
</tr>
<tr>
<td>TINYBLOB</td>
<td>Blob最大长度为255字节</td>
</tr>
</tbody>
</table>
<h1 id="多表关系"><a href="#多表关系" class="headerlink" title="多表关系"></a>多表关系</h1><p>》 多表关系</p>
<ol>
<li><p>一对一（一夫一妻）</p>
</li>
<li><p>一对多(会员与订单)</p>
</li>
<li><p>对多多(商品与订单) </p>
</li>
</ol>
<h2 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h2><p>》 概述</p>
<ul>
<li>主表添加外键字段，该字段的约束为唯一</li>
<li>添加外键约束</li>
</ul>
<h2 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h2><p>》 概述</p>
<ul>
<li>主表添加外键字段，该字段的约束为不唯一</li>
<li>添加外键约束</li>
</ul>
<h2 id="多对多"><a href="#多对多" class="headerlink" title="多对多"></a>多对多</h2><p>》 概述</p>
<ul>
<li>需要重建表完成多对多</li>
<li>实质为两个一对多的关系</li>
<li>首先创建中间表，并在其中创建多对多关系中两张表的外键列</li>
<li>中间表添加外键约束</li>
<li>中间表添加联合主键约束</li>
</ul>
<h2 id="联结"><a href="#联结" class="headerlink" title="联结"></a>联结</h2><p>》 当数据存储在多个表中，使用联结方式，在单条SELECT 语句检索出数据。</p>
<p>JOIN按照功能可分为</p>
<ul>
<li>CROSS JOIN(交叉连接)</li>
<li>INNER JOIN(内连接或等值连接)</li>
<li>OUTER JOIN(外连接)</li>
</ul>
<p>》 此外，还有其他连接</p>
<ul>
<li>自连接: 双表都是自身时使用</li>
<li>自然联结: 多表连接查询所有列，保证出现重复列</li>
</ul>
<h3 id="交叉连接"><a href="#交叉连接" class="headerlink" title="交叉连接"></a>交叉连接</h3><p>》 又名笛卡儿积连接,检索出的行的数目将是第一个表中的行数乘以第二个表中的行数。</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//隐式交叉连接</span></span><br><span class="line">SELECT * FROM A,B;</span><br><span class="line"><span class="comment">//显示交叉连接</span></span><br><span class="line">SELECT * FROM A CROSS JOIN B;</span><br></pre></td></tr></table></figure></div>
<h3 id="内连接或等值连接"><a href="#内连接或等值连接" class="headerlink" title="内连接或等值连接"></a>内连接或等值连接</h3><p>》 内连接使用比较运算符根据每个表共有的列的值匹配两个表中的行</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//隐式内连接</span></span><br><span class="line">SELECT * FROM A,B WHERE A.id = B.id;</span><br><span class="line"><span class="comment">//显示内连接</span></span><br><span class="line">SELECT * FORM A INNER JOIN B ON A.id = B.id;</span><br></pre></td></tr></table></figure></div>
<h3 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h3><p>》 外连接包括</p>
<ul>
<li>左外连接</li>
<li>右外连接</li>
</ul>
<p>》 此外，外连接需要有主表或者保留表的概念；查询结果会以主表为主，从表记录匹配不到，则补NULL</p>
<h4 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h4><p>》 其中A为主表</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM A LEFT JOIN B ON A.id = B.od;</span><br><span class="line">//或</span><br><span class="line">SELECT * FROM A LEFT OUTER JOIN B ON A.id = B.od;</span><br></pre></td></tr></table></figure></div>
<h4 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h4><p>》 其中B为主表</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM A RIGHT JOIN B ON A.id = B.od;</span><br><span class="line">//或</span><br><span class="line">SELECT * FROM A RIGHT OUTER JOIN B ON A.id = B.od;</span><br></pre></td></tr></table></figure></div>
<p>》 使用表别名(可以省写表名)</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT cust_name, cust_contact</span><br><span class="line">FROM customers AS c, orders AS o, orderitems AS oi</span><br><span class="line">WHERE c.cust_id = o.cust_id</span><br><span class="line">AND oi.order_num = o.order_num</span><br><span class="line">AND prod_id = &apos;TNT2&apos;</span><br></pre></td></tr></table></figure></div>
<h3 id="自联结"><a href="#自联结" class="headerlink" title="自联结"></a>自联结</h3><p>》 使用情况，如一个货物id为DTNTR,想要查询这个货物对应厂商的其他货物，就需要使用自联结了。（p1、p2实际为一张表）</p>
<ol>
<li>第一步：查询到id为DTNTR对应的vend_id</li>
<li>第二步：查询到vend_id对应的prod_id, prod_name</li>
</ol>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT p1.prod_id, p1.prod_name</span><br><span class="line">FROM products AS p1, products AS p2</span><br><span class="line">WHERE p1.vend_id = p2.vend_id</span><br><span class="line">AND p2.prod_id = &apos;DTNTR&apos;</span><br></pre></td></tr></table></figure></div>
<h3 id="自然联结"><a href="#自然联结" class="headerlink" title="自然联结"></a>自然联结</h3><p>》 使用情况，在对表进行联结时，肯定会有至少一个列的值时重复的。而自然联结，就是排除多次出现的列。使每个列只返回一次，具体做法</p>
<ul>
<li>对一张表使用SELECT *</li>
<li>其他表的列使用明确的子集</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT c.*, </span><br><span class="line">		o.order_num,</span><br><span class="line">		o.order_date,</span><br><span class="line">		oi.prod_id, </span><br><span class="line">		oi.quantity, </span><br><span class="line">		oi.item_price</span><br><span class="line">FROM customers AS c, orders AS o, orderitems AS oi</span><br><span class="line">WHERE c.cust_id = o.cust_id</span><br><span class="line">AND oi.order_num = o.order_num</span><br><span class="line">AND prod_id = &apos;FB&apos;</span><br></pre></td></tr></table></figure></div>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>》 事务：</p>
<ul>
<li>指的是逻辑上一组操作，组成这个事务的各个执行单元，要么一起成功,要么一起</li>
<li>InnoDB引擎支持</li>
</ul>
<p>》 相关术语</p>
<ul>
<li>事务（transaction）：指一组SQL语句；</li>
<li>回滚（rollback）：撤销指定SQL语句的过程</li>
<li>提交（commit）：将为存储的SQL语句结果写入数据库表</li>
<li>保留点（savepoint）：指事务处理中设置的临时占位符（placeholder），可以对它发布回滚（与回滚整个事务处理不同）</li>
</ul>
<p>》 事务的特性(ACID)</p>
<ol>
<li>原子性（Atomicity）<br>原子性是指事务包含的所有操作要么全部成功，要么全部失败回滚</li>
<li>一致性（Consistency）<br>一致性是指事务必须使数据库从一个一致性状态变换到另一个一致性状态，也就是说一个事务执行之前和执行之后都必须处于一致性状态(如转账，两个人怎么转，总金额是不会变的)</li>
<li>隔离性（Isolation）<br>隔离性是当多个用户并发访问数据库时，比如操作同一张表时，数据库为每一个用户开启的事务，不能被其他事务的操作所干扰，多个并发事务之间要相互隔离</li>
<li>持久性（Durability）<br>持久性是指一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的，即便是在数据库系统遇到故障的情况下也不会丢失提交事务的操作</li>
</ol>
<h2 id="事务并发问题（隔离性导致）"><a href="#事务并发问题（隔离性导致）" class="headerlink" title="事务并发问题（隔离性导致）"></a>事务并发问题（隔离性导致）</h2><p>在事务的并发操作中可能会出现一些问题：</p>
<ol>
<li>脏读：一个事务读取到另一个事务未提交的数据。</li>
<li>不可重复读：一个事务因读取到另一个事务已提交的数据。导致对同一条记录读取两次以上的结果不一致。(update操作，读取的内容改变)</li>
<li>幻读：一个事务因读取到另一个事务已提交的数据。导致对同一张表读取两次以上的结果不一致。(insert、delete操作,返回的结果行数改变)</li>
</ol>
<h2 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h2><p>MySQL数据库为我们提供的四种隔离级别（由低到高）：</p>
<ol>
<li>Read uncommitted (读未提交)：最低级别，任何情况都无法保证。</li>
<li>Read committed (读已提交)：可避免脏读的发生。</li>
<li>Repeatable read (可重复读)：可避免脏读、不可重复读的发生。[MySQL默认]</li>
<li>Serializable (串行化)：可避免脏读、不可重复读、幻读的发生。</li>
</ol>
<p>》 注意  </p>
<p>》》 隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能的影响也越大。<br>对于多数应用程序，可以优先考虑把数据库系统的隔离级别设为Read Committed。它能够避免脏读取，而且具有较好的并发性能。尽管它会导致不可重复读、幻读这些并发问题，在可能出现这类问题的个别场合，可以由应用程序采用悲观锁或乐观&gt;锁来控制。</p>
<h2 id="事务SQL"><a href="#事务SQL" class="headerlink" title="事务SQL"></a>事务SQL</h2><p>》 开始事务</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">START TRANSACTION</span><br></pre></td></tr></table></figure></div>
<p>.</p>
<p>》 回滚事务</p>
<ul>
<li>只能在一个事务处理内使用（在执行一条START TRANSACTION命令之后）</li>
<li>事务处理可以用来管理INSERT、UPDATE、DELETE</li>
<li>不能回滚CREATE和DROP操作</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROLLBACK</span><br></pre></td></tr></table></figure></div>
<p>提交事务</p>
<ul>
<li>数据库默认是自动提交的</li>
<li>但在事务处理快中，不会自动提交，需要手动COMMIT</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COMMIT</span><br></pre></td></tr></table></figure></div>
<p>》 关闭事务：执行COMMIT和ROLLBACK后自动关闭</p>
<p>》 设置保留点</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SAVEPOINT point</span><br></pre></td></tr></table></figure></div>
<p>》 回滚到保留点</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROLLBACK TO point</span><br></pre></td></tr></table></figure></div>
<p>》 释放保留点:（执行完ROLLBACK或COMMIT后自动释放，或RELEASE SAVEPOINT明确释放）</p>
<p>》 更改系统默认的提交行为 </p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//表示不自动提交。Mysql默认自动提交。</span></span><br><span class="line">SET autocommit=<span class="number">0</span></span><br></pre></td></tr></table></figure></div>
<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><p>》 简介</p>
<ul>
<li>使用索引的目的时为了优化查询速度</li>
<li>索引时一种特殊的文件或者叫数据结构（InnoDB数据表上的索引是表空间的一个组成部分），它包含对数据表里的所有记录的引用指针</li>
<li>通俗的讲，索引就相当一数据库的目录</li>
</ul>
<p>》 因为索引是在存储引擎中实现，所以不同存储引擎有不同索引</p>
<ul>
<li>MyISAM和InnoDB:只支持BTREE索引</li>
<li>MEMORY/HEAP存储引起：支持HASH和BTREE索引</li>
</ul>
<h2 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h2><p>》 索引分类</p>
<ul>
<li>单列索引</li>
<li>组合索引</li>
</ul>
<p>》 单列索引</p>
<ul>
<li>普通索引：MySQL中基本索引类型，没有限制，允许定义索引的列中插入重复值和空值</li>
<li>唯一索引：索引列中的值必须是唯一的，但允许NULL</li>
<li>主键索引：特殊唯一索引，不允许NULL</li>
</ul>
<p>》 组合索引</p>
<ul>
<li>在表中的多个字段组合上创建的索引，只有在查询条件中使用了这些字段的左边字段时，索引才会被使用，使用组合索引时遵循最左前缀集合。</li>
</ul>
<p>》 全文索引</p>
<ul>
<li>全文索引，只有在MyISAM引擎上才能使用，只能在CHAR,VARCHAR,TEXT类型字段上使用全文索引。</li>
</ul>
<p>此外，还有空间索引，不常用.</p>
<h2 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h2><p>》 普通索引的创建</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建索引</span></span><br><span class="line">CREATE INDEX &lt;index-name&gt; ON &lt;table-name&gt;(</span><br><span class="line">    &lt;column-name&gt;(length)</span><br><span class="line">)</span><br><span class="line"><span class="comment">//另一种方式</span></span><br><span class="line">ALTER TABLE  &lt;table-name&gt; ADD INDEX &lt;index-name&gt; ON (</span><br><span class="line">    &lt;column-name&gt;(length)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>
<p>》 唯一索引的创建</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建索引</span></span><br><span class="line">CREATE UNIQUE INDEX &lt;index-name&gt; ON &lt;table-name&gt;(</span><br><span class="line">    &lt;column-name&gt;(length)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>
<p>》 全文索引创建</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建索引</span></span><br><span class="line">CREATE FULLTEXT INDEX &lt;index-name&gt; ON &lt;table-name&gt;(</span><br><span class="line">    &lt;column-name&gt; (length)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>
<p>》 组合索引的创建</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建索引</span></span><br><span class="line">CREATE [FULLTEXT/UNIQUE] INDEX &lt;index-name&gt; ON &lt;table-name&gt;(</span><br><span class="line">    &lt;column-name&gt;(length),</span><br><span class="line">    &lt;column-name&gt;(length)</span><br><span class="line">    ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>
<h2 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX &lt;index-name&gt; ON &lt;table-name&gt;</span><br></pre></td></tr></table></figure></div>
<h1 id="MySQL的锁"><a href="#MySQL的锁" class="headerlink" title="MySQL的锁"></a>MySQL的锁</h1><p>》 简介：</p>
<ul>
<li>事务在对某个数据对象（如表、记录等）操作之前，先向系统发出请求，对其加锁，加锁后事务就对数据库对象有一定的控制，在事务释放它的锁之前，其他事务不能更新此数据对象。</li>
<li>数据库锁定机制简单来说就是数据库为了保证数据的一致性而使各种共享资源在被并发访问访问</li>
<li>MySQL数据库由于存在多种数据存储引擎,每种存储引擎的锁定机制都是为各自所面对的特定场景而优化设计，所以各存储引擎的锁定机制也有较大区别</li>
</ul>
<p>》 MySQL各存储引擎使用了三种类型（级别）的锁定机制</p>
<ul>
<li>行级锁定:开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最低，并发度也最高</li>
<li>页级锁定:开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表锁和行锁之间，并发度一般。</li>
<li>表级锁定:开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最高，并发度最低</li>
</ul>
<p>》 MySQL这三种锁定的特点和各自的优劣所在</p>
<ul>
<li>按照锁的粒度来分：行级锁、表级锁、页级锁定</li>
<li>按照锁的功能来分：共享读锁和排他写锁</li>
</ul>
<p>》 各引擎对锁的支持</p>
<ul>
<li>MyISAM和MEMORY存储引擎采用的表级锁</li>
<li>BDB采用的是页面锁，也支持表级锁</li>
<li>InnoDB存储引擎既支持行级锁，也支持表级锁，默认情况下采用行级锁。</li>
</ul>
<h2 id="排他锁"><a href="#排他锁" class="headerlink" title="排他锁"></a>排他锁</h2><p>》 介绍:</p>
<ul>
<li>又称写锁，X锁</li>
<li>允许当前请求进行读取和修改，同时阻塞其他请求读取和修改</li>
</ul>
<h2 id="共享锁"><a href="#共享锁" class="headerlink" title="共享锁"></a>共享锁</h2><p>》 介绍:</p>
<ul>
<li>又称读锁，S锁</li>
<li>允许当前请求进行读取，同时阻塞其他请求修改,但其他请求可以进行读取</li>
</ul>
<h2 id="行级锁"><a href="#行级锁" class="headerlink" title="行级锁"></a>行级锁</h2><p>》 特点</p>
<ul>
<li>行级别粒度，最小的粒度</li>
<li>由于锁定颗粒度很小，所以发生锁定资源争用的概率也最小，能够给予应用程序尽可能大的并发处理能力而提高一些需要高并发应用系统的整体性能</li>
<li>更适合于有大量按索引条件并发更新少量不同数据，同时又有并发查询的应用</li>
</ul>
<p>缺点</p>
<ul>
<li>锁定资源的颗粒度很小，占用系统资源大,并发度最高</li>
<li>过多的锁也最容易发生死锁</li>
</ul>
<h2 id="表级锁"><a href="#表级锁" class="headerlink" title="表级锁"></a>表级锁</h2><p>》 特点</p>
<ul>
<li>表级别粒度，最大的粒度</li>
<li>实现逻辑简单，带来的系统负面影响最小</li>
<li>获取锁和释放锁的速度很快</li>
<li>不会出现死锁</li>
<li>更适合于以查询为主，只有少量按索引条件更新数据的应用</li>
</ul>
<p>》 缺点</p>
<ul>
<li>出现锁定资源争用的概率高,并发度差</li>
</ul>
<h2 id="页级锁"><a href="#页级锁" class="headerlink" title="页级锁"></a>页级锁</h2><p>》 特点</p>
<ul>
<li>MySQL特有的锁</li>
<li>所需资源和粒度都介于表级锁和行级锁之间</li>
<li>并发处理能力在三种锁之间最高</li>
</ul>
<p>》 缺点</p>
<ul>
<li>会发生死锁</li>
</ul>
<h2 id="MyISAM引擎的锁机制"><a href="#MyISAM引擎的锁机制" class="headerlink" title="MyISAM引擎的锁机制"></a>MyISAM引擎的锁机制</h2><p>》 MyISAM只有表级锁</p>
<ul>
<li>表共享读锁（table read lock）</li>
<li>表独占写锁（table write lock）。</li>
</ul>
<p>》 MyISAM表的读、写操作之间、以及写操作之间的隔离级别是串行级别，其处理流程如下：</p>
<ul>
<li>MyISAM在执行查询语句（SELECT）前，会自动给涉及的所有表加读锁</li>
<li>在执行更新操作（UPDATE、DELETE、INSERT等）前，会自动给涉及的表加写锁</li>
<li>用户一般不需要直接用LOCK TABLE命令给MyISAM表显式加锁</li>
</ul>
<p>》 <strong>注意:MyISAM是不支持事务的</strong></p>
<h3 id="MyISAM手动更改优先级"><a href="#MyISAM手动更改优先级" class="headerlink" title="MyISAM手动更改优先级"></a>MyISAM手动更改优先级</h3><p>》 方式:</p>
<ul>
<li>通过执行命令SET LOW_PRIORITY_UPDATES=1，使该连接发出的更新请求优先级降低。</li>
<li>通过指定INSERT、UPDATE、DELETE语句的LOW_PRIORITY属性，降低该语句的优先级。</li>
<li>给系统参数max_write_lock_count设置一个合适的值，当一个表的读锁达到这个值后，MySQL变暂时将写请求的优先级降低，给读进程一定获得锁的机会。</li>
</ul>
<h3 id="MyISAM的并发插入"><a href="#MyISAM的并发插入" class="headerlink" title="MyISAM的并发插入"></a>MyISAM的并发插入</h3><p>》 MyISAM存储引擎有一个系统变量，concurrent_insert，专门用来控制并发插入行为的，值可以为0，1，2.</p>
<ul>
<li>值为0：不允许插入</li>
<li>值为1：如果mysql没有空洞（中间没有被删除的行），MyISAM运行一个进程读表的时候，另一个进程从表尾插入记录，这也是mysql默认设置。</li>
<li>值为2，无论MyISAM表中有没有空洞，都允许在表尾并行的插入。</li>
</ul>
<h2 id="InnoDB引擎的锁机制"><a href="#InnoDB引擎的锁机制" class="headerlink" title="InnoDB引擎的锁机制"></a>InnoDB引擎的锁机制</h2><p>》 与MyISAM不同:</p>
<ul>
<li>支持事务</li>
<li>支持行级锁</li>
</ul>
<p>》 流程</p>
<ul>
<li>对于UPDATE、DELETE、INSERT语句，Innodb会自动给涉及的数据集加排他锁（X）</li>
<li>对于普通SELECT语句，Innodb不会加任何锁。</li>
</ul>
<h3 id="Innodb行锁模式以及加锁方法"><a href="#Innodb行锁模式以及加锁方法" class="headerlink" title="Innodb行锁模式以及加锁方法"></a>Innodb行锁模式以及加锁方法</h3><p>》 Innodb锁模式一共分为</p>
<ul>
<li>共享锁</li>
<li>排他锁</li>
<li>意向锁(意向共享锁、意向排他锁)</li>
</ul>
<p>》  冲突情况：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>共享锁</td>
<td>排他锁</td>
<td>意向共享锁</td>
<td>意向排他锁</td>
</tr>
<tr>
<td>共享锁</td>
<td>兼容</td>
<td>冲突</td>
<td>兼容</td>
<td>冲突</td>
</tr>
<tr>
<td>排他锁</td>
<td>冲突</td>
<td>冲突</td>
<td>冲突</td>
<td>冲突</td>
</tr>
<tr>
<td>意向共享锁</td>
<td>兼容</td>
<td>冲突</td>
<td>兼容</td>
<td>兼容</td>
</tr>
<tr>
<td>意向排他锁</td>
<td>冲突</td>
<td>冲突</td>
<td>兼容</td>
<td>兼容</td>
</tr>
</tbody>
</table>
<h3 id="表级锁和行级锁之间的冲突"><a href="#表级锁和行级锁之间的冲突" class="headerlink" title="表级锁和行级锁之间的冲突"></a>表级锁和行级锁之间的冲突</h3><p>》 如下情况</p>
<ul>
<li>事务A：行级锁，锁定行H，只读</li>
<li>事务B：表级锁，锁定了行H的表，读写</li>
</ul>
<p>》 数据库的解决办法: 意向锁</p>
<ul>
<li>意向锁是一个表级锁，可以分为意向共享锁(IS)、意向排他锁（IX）</li>
<li>事务A必须先申请意向锁，再申请行级锁</li>
<li>事务B在申请表级锁时，发现表已经有了意向锁，会被阻塞</li>
</ul>
<h1 id="触发器-MySQL5"><a href="#触发器-MySQL5" class="headerlink" title="触发器(MySQL5)"></a>触发器(MySQL5)</h1><p>》 <strong>触发器</strong>：MySQL响应以下任意语句自动执行的的一条MySQL语句</p>
<ul>
<li>其他MySQL语句不支持触发器</li>
<li>只有表支持触发器，视图不支持</li>
<li>每个表最多支持6个触发器（每条INSERT、UPDATE、DELETE的之前之后）.</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DELETE</span><br><span class="line">INSERT</span><br><span class="line">UPDATE</span><br></pre></td></tr></table></figure></div>
<p>》 触发器失败</p>
<ul>
<li>BEFORE触发器失败，不执行请求操作</li>
<li>BEFORE触发器或语句本身失败，不执行AFTER触发器</li>
</ul>
<p>》 创建触发器</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER</span><br></pre></td></tr></table></figure></div>
<p>》 示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//触发器在INSERT语句成功后，对每个插入的行显示一次Product added</span></span><br><span class="line">- 创建了名为newproduct的触发器。</span><br><span class="line">- AFTER INSERT表示触发器在INSERT语句成功后执行</span><br><span class="line">- FOR EACH ROW表示代码对每个插入行执行</span><br><span class="line">- SLELECT <span class="string">'Product added'</span>触发器执行的操作，即显示文本信息Product added</span><br><span class="line"></span><br><span class="line">CREATE TRIGGER newproduct AFERT INSERT ON products</span><br><span class="line">FOR EACH ROW SLELECT <span class="string">'Product added'</span></span><br></pre></td></tr></table></figure></div>
<p>》 删除触发器: 触发器无法更新或覆盖，想要修改触发器，必须先删再创。</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TRIGGER 触发器名</span><br></pre></td></tr></table></figure></div>
<h2 id="INSERT触发器"><a href="#INSERT触发器" class="headerlink" title="INSERT触发器"></a>INSERT触发器</h2><p>》 INSERT触发器</p>
<ul>
<li>在INSERT触发器代码内，可引用一个名为NEW的虚拟表，访问被插入的行</li>
<li>在BEFROE INSERT触发器中，NEW 的值也可以被更新。</li>
<li>对于AUTO_INCREMENT列，NEW在INSERT执行之前包含0，在INSERT执行之后包含新的自动生成值。</li>
</ul>
<p>》 示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//order_num是一个AUTO_INCREMENT列,当orders表成功插入一行数据时，这行数据会保存到NEW中。此触发器执行的操作是SELECT NEW.order_num,即把自动生成的标号显示出来。</span></span><br><span class="line"></span><br><span class="line">CREATE TRIGGER neworder AFTER INSERT ON orders</span><br><span class="line">FOR EACH ROW SELECT NEW.order_num;</span><br></pre></td></tr></table></figure></div>
<h2 id="DELETE触发器"><a href="#DELETE触发器" class="headerlink" title="DELETE触发器"></a>DELETE触发器</h2><p>》DELETE触发器</p>
<ul>
<li>在DELETE触发器代码内，可以引用名为OLD的虚拟表，访问被删除的行</li>
<li>OLD中的值都是只读，无法更新</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将被删除的行的数据保存到archive_orders表中。BEGIN END块的好处是触发器器能容纳多条SQL语句。</span></span><br><span class="line"></span><br><span class="line">CREATE TRIGGER deleteorder BEFORE DELETE ON roders</span><br><span class="line">FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">	<span class="function">INSERT INTO <span class="title">archive_orders</span><span class="params">(order_num, order_date, cust_id)</span></span></span><br><span class="line"><span class="function">	<span class="title">VALUES</span> <span class="params">(OLD.order_num, OLD.order_date, OLD.cust_id)</span>  </span></span><br><span class="line"><span class="function">END</span>;</span><br></pre></td></tr></table></figure></div>
<h2 id="UPDATE触发器"><a href="#UPDATE触发器" class="headerlink" title="UPDATE触发器"></a>UPDATE触发器</h2><p>》 UPDATE触发器</p>
<ul>
<li>在UPDATE触发器代码中，可以引用名为OLD的虚拟表访问以前的值，引用名为NEW的虚拟表访问新更新的值</li>
<li>BEFORE UPDATE触发器中，NEW中的值可能也被更新<br>OLD只读，不能更新</li>
</ul>
<p>》示例：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在更新以前出发，保证更改的值永远是大写。即在更新前，先对值进行处理。（这就是所谓的NEW值可能被更新）</span></span><br><span class="line"></span><br><span class="line">CREATE TRIGGER updatevendor BEFORE UPDATE ON vendors</span><br><span class="line">FOR EACH ROW SET NEW.ven_state = Upper(NEW.vend_state);</span><br></pre></td></tr></table></figure></div>
<h1 id="视图（MySQL5-）"><a href="#视图（MySQL5-）" class="headerlink" title="视图（MySQL5 ）"></a>视图（MySQL5 ）</h1><p>》 什么是视图</p>
<ul>
<li>将一个SELECT的查询结果包装成一个虚拟的表</li>
<li>本身不包含数据，仅仅用来查看存储在别处的数据的一种设施。</li>
</ul>
<p>》 视图的好处：</p>
<ul>
<li>重复SQL语句</li>
<li>鸡蛋花复杂的SQL操作。在编写查询后，可以方便地重用它而不必知道它的基本查询细节</li>
<li>使用表的组成部分而不是整个表</li>
<li>保护数据，可以给用户授予表的特定部分的访问权限而不是整个表的访问权限</li>
<li>更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。</li>
</ul>
<p>》 规则和限制</p>
<ul>
<li>与表一样，视图名唯一</li>
<li>对于可创建的视图数目没有限制</li>
<li>为了创建视图，必须具有足够的访问权限</li>
<li>可以嵌套，即可以利用从其他视图中检索数据的查询来构造一个视图</li>
<li>ORDER BY可以用在视图中。但如果从该视图检索数据SELECT中也含有ORDER BY,那么视图中的ORDER BY被覆盖。</li>
<li>视图不能索引，也不能由关联的触发器或默认值</li>
<li>视图可以和表一起使用。例如编写一条联结表和视图的SELECT语句</li>
</ul>
<h2 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW 视图名</span><br></pre></td></tr></table></figure></div>
<p>》 示例：</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW prdouccustomers AS</span><br><span class="line">SELECT  cust_name, cust_contact, prod_id</span><br><span class="line">FROM customers, orders, orderitems</span><br><span class="line">WHERE customers.cust_id = orders.cust_id</span><br><span class="line">AND orderitems.order_num = orders.order_num</span><br></pre></td></tr></table></figure></div>
<h2 id="查看创建视图的语句"><a href="#查看创建视图的语句" class="headerlink" title="查看创建视图的语句"></a>查看创建视图的语句</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE VIEW viewname</span><br></pre></td></tr></table></figure></div>
<h2 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h2><p>》 方式一：先DROP在CREATE</p>
<p>》 方式二：不存在则创建，存在就覆盖</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW</span><br></pre></td></tr></table></figure></div>
<p>》  个人理解：</p>
<ul>
<li>创建完视图后，发现通过SHOW TABLES可以查看到视图（暂且理解为视图其实算是一种特殊的表）</li>
<li>通过SHOW CREATE TABLE 视图,也可以显示视图的创造语句（更加觉得视图是一种特殊的表）</li>
<li>在实际使用中，可以当表来进行操作(WHERE，ORDER BY等)</li>
<li>虽然视图也可以做到更新（改动基表），但视图本身是用于检索，所以想要更新数据，还是直接操作基表比较好</li>
</ul>
<h1 id="存储过程-MySQL5"><a href="#存储过程-MySQL5" class="headerlink" title="存储过程(MySQL5)"></a>存储过程(MySQL5)</h1><h2 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><figcaption><span>PROCEDURE 存储过程名() BEGIN 语句; END</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE productname()</span><br><span class="line">...</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></div>
<p>》 示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE productpricing()</span><br><span class="line">BEGIN </span><br><span class="line">SELECT avg(prod_price) AS priceaverage</span><br><span class="line">FROM products;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></div>
<h2 id="命令行模式下的DELIMITER"><a href="#命令行模式下的DELIMITER" class="headerlink" title="命令行模式下的DELIMITER //"></a>命令行模式下的<code>DELIMITER //</code></h2><p>》 MySQL命令行默认使用;来表示分隔符。而MySQL语句也使用;表示。这样还没执行到END，就在前面的;就结束了。DELIMITER //是将MySQL命令行的分隔符修改。</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER //</span><br><span class="line">CREATE PROCEDURE productpricing()</span><br><span class="line">BEGIN </span><br><span class="line">SELECT avg(prod_price) AS priceaverage</span><br><span class="line">FROM products;</span><br><span class="line">END//</span><br></pre></td></tr></table></figure></div>
<h2 id="使用存储过程"><a href="#使用存储过程" class="headerlink" title="使用存储过程"></a>使用存储过程</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CALL productpricing()</span><br></pre></td></tr></table></figure></div>
<h2 id="删除存储过程"><a href="#删除存储过程" class="headerlink" title="删除存储过程"></a>删除存储过程</h2><p>》 过程不存在回产生错误，可使用DROP PROCEDURE IF EXISTS 存储过程名</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE 存储过程名</span><br><span class="line">DROP PROCEDURE IF EXISTS 存储过程名</span><br></pre></td></tr></table></figure></div>
<h2 id="使用参数"><a href="#使用参数" class="headerlink" title="使用参数"></a>使用参数</h2><p>》 主要参数如下</p>
<ul>
<li>IN：传递给存储过程</li>
<li>OUT：从存储过程传出</li>
<li>INOUT：可传入传出</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//IN需要传入数据（20005）,SELECT的数据通过INTO传入到ototal中。通过SELECT @total查看变量的值。</span></span><br><span class="line"></span><br><span class="line"><span class="function">CREATE PROCEDURE <span class="title">ordertotal</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">	IN onumber INT,</span></span></span><br><span class="line"><span class="function"><span class="params">	OUT ototal DECIMAL(<span class="number">8</span>, <span class="number">2</span>)</span></span></span><br><span class="line"><span class="function">)</span></span><br><span class="line"><span class="function">BEGIN </span></span><br><span class="line"><span class="function">	SELECT <span class="title">sum</span><span class="params">(item_price*quantity)</span></span></span><br><span class="line"><span class="function">	FROM orderitems</span></span><br><span class="line"><span class="function">	WHERE order_num </span>= onumber </span><br><span class="line">	INTO ototal;</span><br><span class="line">END;</span><br><span class="line"><span class="function">CALL <span class="title">ordertotal</span><span class="params">(<span class="number">20005</span>, @total)</span></span>;</span><br><span class="line">SELECT <span class="meta">@total</span>;</span><br></pre></td></tr></table></figure></div>
<h2 id="检查存储过程"><a href="#检查存储过程" class="headerlink" title="检查存储过程"></a>检查存储过程</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE 存储过程</span><br></pre></td></tr></table></figure></div>
<h2 id="列出所有存储过程"><a href="#列出所有存储过程" class="headerlink" title="列出所有存储过程"></a>列出所有存储过程</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WHO PROCEDURE STATUS</span><br></pre></td></tr></table></figure></div>
<h2 id="可以使用LIKE过滤-如"><a href="#可以使用LIKE过滤-如" class="headerlink" title="可以使用LIKE过滤,如"></a>可以使用LIKE过滤,如</h2><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WHO PROCEDURE STATUS LIKE &apos;ordertotal&apos;</span><br></pre></td></tr></table></figure></div>
<h2 id="使用游标-MySQL5"><a href="#使用游标-MySQL5" class="headerlink" title="使用游标(MySQL5)"></a>使用游标(MySQL5)</h2><p>》 游标(cursor)</p>
<ul>
<li><p>存储在MySQL服务器上的数据库查询，不是SELECT语句，而是被该语句检索出来的结果集。</p>
</li>
<li><p>根据需要滚动或浏览其中的数据</p>
</li>
<li><p>主要用于交互式应用</p>
</li>
<li><p>只能用于存储过程（和函数）</p>
</li>
</ul>
<h3 id="游标的使用"><a href="#游标的使用" class="headerlink" title="游标的使用"></a>游标的使用</h3><ul>
<li>先声明游标，这个过程没有检索数据。只用来定义要使用的SELECT语句</li>
<li>声明后，打开游标。这个过程用前面定义的SELECT语句把数据检索出来</li>
<li>对于填有数据的游标，根据需要检索各行</li>
<li>在结束游标使用时，必须关闭游标（如果不明确关闭游标，MySQL会在达到END语句时自动关闭）</li>
</ul>
<h3 id="创建游标"><a href="#创建游标" class="headerlink" title="创建游标"></a>创建游标</h3><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DECLARE 游标名 CURSOR FOR</span><br></pre></td></tr></table></figure></div>
<p>》  示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="JAVA"><figure class="iseeu highlight /java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//如,定义了名为ordernumbers的游标</span></span><br><span class="line"></span><br><span class="line"><span class="function">CREATE PROCEDURE <span class="title">processorders</span><span class="params">()</span></span></span><br><span class="line"><span class="function">BEGIN </span></span><br><span class="line"><span class="function">-- 定义游标</span></span><br><span class="line"><span class="function">DECLARE ordernumbers CURSOR</span></span><br><span class="line"><span class="function">FOR </span></span><br><span class="line"><span class="function">SELECT order_num FROM orders</span>;</span><br><span class="line">-- 打开游标</span><br><span class="line">OPEN ordernumbers;</span><br><span class="line">-- 关闭游标</span><br><span class="line">CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></div>
<h3 id="打开游标"><a href="#打开游标" class="headerlink" title="打开游标"></a>打开游标</h3><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPEN 游标名</span><br></pre></td></tr></table></figure></div>
<h3 id="关闭游标"><a href="#关闭游标" class="headerlink" title="关闭游标"></a>关闭游标</h3><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CLOSE 游标名</span><br></pre></td></tr></table></figure></div>
<h3 id="使用游标数据"><a href="#使用游标数据" class="headerlink" title="使用游标数据"></a>使用游标数据</h3><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FETCH</span><br></pre></td></tr></table></figure></div>
<p>》 示例</p>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//FETCH语句会自动从第一行开始把order_num列复制到变量o中(这里并没有操作变量o)</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN </span><br><span class="line">-- 定义一个本地变量o</span><br><span class="line">DECLARE o INT;</span><br><span class="line">-- 定义游标</span><br><span class="line">DECLARE ordernumbers CURSOR</span><br><span class="line">FOR </span><br><span class="line">SELECT order_num FROM orders;</span><br><span class="line">-- 打开游标</span><br><span class="line">OPEN ordernumbers;</span><br><span class="line">-- 获取数据</span><br><span class="line">FETCH ordernumbers INTO o;</span><br><span class="line">-- 关闭游标</span><br><span class="line">CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></div>
<p>》  该存储过程执行后，会循环检索数据，从第一行到最后一行</p>
<ul>
<li>FETCH在REPEAT内，所以会反复执行。根据UNTIL done END REPEAT;，直到done为真时结束循环(done默认0，表示假)</li>
<li>CONTINUE HANDER：在条件出现时被执行的代码。这里表名当SQLSTATE ‘02000’出现时，将SET done = 1</li>
<li>SQLSTATE ‘02000’表示一个未找到的条件，当REPEAT没有更多行出供循环而不能继续时，就会出现这个条件</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN </span><br><span class="line">-- 定义一个本地变量o和一个布尔值变量done</span><br><span class="line">DECLARE done BOOLEAN DEFAULT 0;</span><br><span class="line">DECLARE o INT;</span><br><span class="line"></span><br><span class="line">-- 定义游标</span><br><span class="line">DECLARE ordernumbers CURSOR</span><br><span class="line">FOR </span><br><span class="line">SELECT order_num FROM orders;</span><br><span class="line"></span><br><span class="line">-- 定义了一个continue handler,在条件出现时将done设置成1</span><br><span class="line">DECLARE CONTINUE HANDLER FOR SQLSTATE &apos;02000&apos; SET done=1;</span><br><span class="line"></span><br><span class="line">-- 打开游标</span><br><span class="line">OPEN ordernumbers;</span><br><span class="line"></span><br><span class="line">REPEAT</span><br><span class="line">	-- 获取数据</span><br><span class="line">	FETCH ordernumbers INTO o;</span><br><span class="line">UNTIL done END REPEAT;</span><br><span class="line"></span><br><span class="line">-- 关闭游标</span><br><span class="line">CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure></div>
<p>》 示例：</p>
<ul>
<li>创建了一个ordertotals表</li>
<li>定义了一个变量t,使用ordertotal()存储过程为其复制</li>
<li>通过INSERT INTO 将o和t的值插入ordertotals表中</li>
<li>使用 CALL processorders();来使用存储过程,这时表ordertotals应该已经创建好并且有数据了</li>
<li>使用SELECT * FROM ordertotals;来查看下数据</li>
</ul>
<div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders()</span><br><span class="line">BEGIN </span><br><span class="line">-- 定义一个本地变量o、t和一个布尔值变量done</span><br><span class="line">DECLARE done BOOLEAN DEFAULT 0;</span><br><span class="line">DECLARE o INT;</span><br><span class="line">DECLARE t DECIMAL(8, 2);</span><br><span class="line"></span><br><span class="line">-- 定义游标</span><br><span class="line">DECLARE ordernumbers CURSOR</span><br><span class="line">FOR </span><br><span class="line">SELECT order_num FROM orders;</span><br><span class="line"></span><br><span class="line">-- 定义了一个continue handler</span><br><span class="line">DECLARE CONTINUE HANDLER FOR SQLSTATE &apos;02000&apos; SET done=1;</span><br><span class="line"></span><br><span class="line">-- 创建一个表来存储结果</span><br><span class="line">CREATE TABLE IF NOT EXISTS ordertotals(</span><br><span class="line">	order_num INT, </span><br><span class="line">	total DECIMAL(8, 2)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 打开游标</span><br><span class="line">OPEN ordernumbers;</span><br><span class="line"></span><br><span class="line">REPEAT</span><br><span class="line">	-- 获取数据</span><br><span class="line">	FETCH ordernumbers INTO o;</span><br><span class="line">	-- 这里是在学习存储过程中写的一个存储过程,用来计算t的值</span><br><span class="line">	CALL ordertotal(o, t);</span><br><span class="line">	-- 把数据插入表</span><br><span class="line">	INSERT INTO ordertotals(order_num, total)</span><br><span class="line">	VALUES(o, t);</span><br><span class="line">UNTIL done END REPEAT;</span><br><span class="line"></span><br><span class="line">-- 关闭游标</span><br><span class="line">CLOSE ordernumbers;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">CALL processorders();</span><br><span class="line"></span><br><span class="line">SELECT * FROM ordertotals;</span><br></pre></td></tr></table></figure></div>
<h1 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h1><p>》  mysqldump</p>
<ul>
<li>转储所有数据库内容到某个外部文件。在进行常规备份前这个实用程序应该正常运行，以便能正确地备份转储文件。<br>mysqlhotcopy</li>
<li>从一个数据库复制所有数据（并非所有数据库引擎都支持这个实用程序）。</li>
</ul>
<p>》 BACKUP TABLE或SELECT INTO OUTFILE</p>
<ul>
<li>转储所有数据到某个外部文件。这两条语句都接受将要创建的系统文件名，此系统文件必须不存在，否则会出错</li>
<li>数据可以用RESTORE TABLE来复原。</li>
</ul>
<p>》 FLUSH TABLES</p>
<ul>
<li>为了保证所有数据被写到磁盘（包括索引数据），可能需要在进行备份前使用</li>
</ul>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/MySQL/" rel="tag"># MySQL</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2018/02/04/jvm.all/" rel="next" title="JVM">
                <i class="fa fa-chevron-left"></i> JVM
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2018/02/06/mysql.deep.all/" rel="prev" title="MySQL深入">
                MySQL深入 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/blog/images/toux.jpg" alt="Liisyu">
            
              <p class="site-author-name" itemprop="name">Liisyu</p>
              <div class="site-description motion-element" itemprop="description">我只是一个兴趣使然的程序员</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/blog/archives/">
                
                    <span class="site-state-item-count">19</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/blog/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/blog/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:575600714@qq.com.com" title="E-Mail(QQ) &rarr; mailto:575600714@qq.com.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail(QQ)</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:swordmaster2014@gmail.com" title="E-Mail(Google) &rarr; mailto:swordmaster2014@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i>E-Mail(Google)</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/FameLsy" title="GitHub &rarr; https://github.com/FameLsy" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://blog.csdn.net/masorl" title="CSDN &rarr; https://blog.csdn.net/masorl" rel="noopener" target="_blank"><i class="fa fa-fw fa-tree"></i>CSDN</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="tencent://message/?uin=575600714&Site=qq&Menu=yes" title="QQ &rarr; tencent://message/?uin=575600714&Site=qq&Menu=yes" rel="noopener" target="_blank"><i class="fa fa-fw fa-qq"></i>QQ</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="http://liisyu.gitee.io/cv/" title="简历 &rarr; http://liisyu.gitee.io/cv/" rel="noopener" target="_blank"><i class="fa fa-fw fa-user-o"></i>简历</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://messilessblog.com/" title="https://messilessblog.com/" rel="noopener" target="_blank">汪酱 BLOG</a>
                  </li>
                
              </ul>
			   
            </div>
          

          
            
          
          

    <div class="wechat-box">
      <div class="weixin-description">微信扫一扫，联系我</div>
	  <img src="/blog/images/wechat.jpg" alt="wechat">
    </div>


        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#命令行操作"><span class="nav-number">1.</span> <span class="nav-text">命令行操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#登录MySQL"><span class="nav-number">1.1.</span> <span class="nav-text">登录MySQL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看帮助文档"><span class="nav-number">1.2.</span> <span class="nav-text">查看帮助文档</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#退出操作"><span class="nav-number">1.3.</span> <span class="nav-text">退出操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试服务器"><span class="nav-number">1.4.</span> <span class="nav-text">测试服务器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#导入sql文件"><span class="nav-number">1.5.</span> <span class="nav-text">导入sql文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据库相关操作"><span class="nav-number">2.</span> <span class="nav-text">数据库相关操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建数据库"><span class="nav-number">2.1.</span> <span class="nav-text">创建数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用数据库"><span class="nav-number">2.2.</span> <span class="nav-text">使用数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看所有数据库"><span class="nav-number">2.3.</span> <span class="nav-text">查看所有数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#显示创建数据库语句"><span class="nav-number">2.4.</span> <span class="nav-text">显示创建数据库语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除数据库"><span class="nav-number">2.5.</span> <span class="nav-text">删除数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看正在使用的数据库"><span class="nav-number">2.6.</span> <span class="nav-text">查看正在使用的数据库</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#表相关操作"><span class="nav-number">3.</span> <span class="nav-text">表相关操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建表"><span class="nav-number">3.1.</span> <span class="nav-text">创建表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看当前数据库所有表"><span class="nav-number">3.2.</span> <span class="nav-text">查看当前数据库所有表:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#显示创建表语句"><span class="nav-number">3.3.</span> <span class="nav-text">显示创建表语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看表列-结构"><span class="nav-number">3.4.</span> <span class="nav-text">查看表列(结构)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看表列另一种方式-效果一样"><span class="nav-number">3.5.</span> <span class="nav-text">查看表列另一种方式(效果一样)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看自动增量的值"><span class="nav-number">3.6.</span> <span class="nav-text">查看自动增量的值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#修改表"><span class="nav-number">3.7.</span> <span class="nav-text">修改表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#定义外键"><span class="nav-number">3.8.</span> <span class="nav-text">定义外键</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除外键"><span class="nav-number">3.9.</span> <span class="nav-text">删除外键</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#用户相关操作"><span class="nav-number">4.</span> <span class="nav-text">用户相关操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#获取所有账号列表"><span class="nav-number">4.1.</span> <span class="nav-text">获取所有账号列表,</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建用户"><span class="nav-number">4.2.</span> <span class="nav-text">创建用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重命名"><span class="nav-number">4.3.</span> <span class="nav-text">重命名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设置-更新密码"><span class="nav-number">4.4.</span> <span class="nav-text">设置/更新密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除账号"><span class="nav-number">4.5.</span> <span class="nav-text">删除账号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#授权"><span class="nav-number">4.6.</span> <span class="nav-text">授权</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除权限"><span class="nav-number">4.7.</span> <span class="nav-text">删除权限</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可用权限"><span class="nav-number">4.8.</span> <span class="nav-text">可用权限</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SELECT"><span class="nav-number">5.</span> <span class="nav-text">SELECT</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#查询语法"><span class="nav-number">5.1.</span> <span class="nav-text">查询语法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#查询原理"><span class="nav-number">6.</span> <span class="nav-text">查询原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#别名查询"><span class="nav-number">6.1.</span> <span class="nav-text">别名查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#运算查询"><span class="nav-number">6.2.</span> <span class="nav-text">运算查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT-子句"><span class="nav-number">6.3.</span> <span class="nav-text">SELECT 子句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SELECT-子句顺序"><span class="nav-number">6.3.1.</span> <span class="nav-text">SELECT 子句顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WHERE（位于ORDER-BY之前）"><span class="nav-number">6.3.2.</span> <span class="nav-text">WHERE（位于ORDER BY之前）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#指定单个搜索条件"><span class="nav-number">6.3.2.1.</span> <span class="nav-text">指定单个搜索条件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WHERE-可用条件"><span class="nav-number">6.3.2.2.</span> <span class="nav-text">WHERE 可用条件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#通配操作符LIKE"><span class="nav-number">6.3.2.3.</span> <span class="nav-text">通配操作符LIKE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#正则表达式REGEXP"><span class="nav-number">6.3.2.4.</span> <span class="nav-text">正则表达式REGEXP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LIKE与RNGEXP的不同"><span class="nav-number">6.3.2.5.</span> <span class="nav-text">LIKE与RNGEXP的不同</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY-WHERE子句之后，ORDER-BY之前"><span class="nav-number">6.3.3.</span> <span class="nav-text">GROUP BY(WHERE子句之后，ORDER BY之前)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HAVING"><span class="nav-number">6.3.4.</span> <span class="nav-text">HAVING</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ORDER-BY（位于-WHERE-之后）"><span class="nav-number">6.3.5.</span> <span class="nav-text">ORDER BY（位于 WHERE 之后）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LIMIT"><span class="nav-number">6.3.6.</span> <span class="nav-text">LIMIT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子查询"><span class="nav-number">6.4.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#利用子查询过滤"><span class="nav-number">6.4.1.</span> <span class="nav-text">利用子查询过滤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作为计算字段使用子查询"><span class="nav-number">6.4.2.</span> <span class="nav-text">作为计算字段使用子查询</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#组合查询-UNION"><span class="nav-number">7.</span> <span class="nav-text">组合查询 UNION</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#全文本搜索"><span class="nav-number">8.</span> <span class="nav-text">全文本搜索</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#INSERT"><span class="nav-number">9.</span> <span class="nav-text">INSERT</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#插入完整的行"><span class="nav-number">9.1.</span> <span class="nav-text">插入完整的行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#插入多个行"><span class="nav-number">9.2.</span> <span class="nav-text">插入多个行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#插入检索出的数据"><span class="nav-number">9.3.</span> <span class="nav-text">插入检索出的数据:</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#UPDATE"><span class="nav-number">10.</span> <span class="nav-text">UPDATE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#更新数据"><span class="nav-number">10.1.</span> <span class="nav-text">更新数据</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DELETE"><span class="nav-number">11.</span> <span class="nav-text">DELETE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#删除行"><span class="nav-number">11.1.</span> <span class="nav-text">删除行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更快的全部删除"><span class="nav-number">11.2.</span> <span class="nav-text">更快的全部删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更新和删除所遵循的习惯"><span class="nav-number">11.3.</span> <span class="nav-text">更新和删除所遵循的习惯</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#函数"><span class="nav-number">12.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常用的文本处理函数"><span class="nav-number">12.1.</span> <span class="nav-text">常用的文本处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用时间和日期处理函数"><span class="nav-number">12.2.</span> <span class="nav-text">常用时间和日期处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数值处理函数"><span class="nav-number">12.3.</span> <span class="nav-text">数值处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#聚焦函数"><span class="nav-number">12.4.</span> <span class="nav-text">聚焦函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#字符集"><span class="nav-number">13.</span> <span class="nav-text">字符集</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#字符集相关操作"><span class="nav-number">13.1.</span> <span class="nav-text">字符集相关操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL使用字符集和校对规则"><span class="nav-number">13.2.</span> <span class="nav-text">MySQL使用字符集和校对规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列级别的字符和校对"><span class="nav-number">13.3.</span> <span class="nav-text">列级别的字符和校对</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据类型"><span class="nav-number">14.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常用数据类型"><span class="nav-number">14.1.</span> <span class="nav-text">常用数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数值数据类型"><span class="nav-number">14.2.</span> <span class="nav-text">数值数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日期和时间数据类型"><span class="nav-number">14.3.</span> <span class="nav-text">日期和时间数据类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二进制数据类型"><span class="nav-number">14.4.</span> <span class="nav-text">二进制数据类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#多表关系"><span class="nav-number">15.</span> <span class="nav-text">多表关系</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一对一"><span class="nav-number">15.1.</span> <span class="nav-text">一对一</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一对多"><span class="nav-number">15.2.</span> <span class="nav-text">一对多</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#多对多"><span class="nav-number">15.3.</span> <span class="nav-text">多对多</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#联结"><span class="nav-number">15.4.</span> <span class="nav-text">联结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#交叉连接"><span class="nav-number">15.4.1.</span> <span class="nav-text">交叉连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内连接或等值连接"><span class="nav-number">15.4.2.</span> <span class="nav-text">内连接或等值连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#外连接"><span class="nav-number">15.4.3.</span> <span class="nav-text">外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#左外连接"><span class="nav-number">15.4.3.1.</span> <span class="nav-text">左外连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#右外连接"><span class="nav-number">15.4.3.2.</span> <span class="nav-text">右外连接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自联结"><span class="nav-number">15.4.4.</span> <span class="nav-text">自联结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自然联结"><span class="nav-number">15.4.5.</span> <span class="nav-text">自然联结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#事务"><span class="nav-number">16.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#事务并发问题（隔离性导致）"><span class="nav-number">16.1.</span> <span class="nav-text">事务并发问题（隔离性导致）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事务隔离级别"><span class="nav-number">16.2.</span> <span class="nav-text">事务隔离级别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事务SQL"><span class="nav-number">16.3.</span> <span class="nav-text">事务SQL</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#索引"><span class="nav-number">17.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#索引分类"><span class="nav-number">17.1.</span> <span class="nav-text">索引分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建索引"><span class="nav-number">17.2.</span> <span class="nav-text">创建索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除索引"><span class="nav-number">17.3.</span> <span class="nav-text">删除索引</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL的锁"><span class="nav-number">18.</span> <span class="nav-text">MySQL的锁</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#排他锁"><span class="nav-number">18.1.</span> <span class="nav-text">排他锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#共享锁"><span class="nav-number">18.2.</span> <span class="nav-text">共享锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#行级锁"><span class="nav-number">18.3.</span> <span class="nav-text">行级锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表级锁"><span class="nav-number">18.4.</span> <span class="nav-text">表级锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#页级锁"><span class="nav-number">18.5.</span> <span class="nav-text">页级锁</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MyISAM引擎的锁机制"><span class="nav-number">18.6.</span> <span class="nav-text">MyISAM引擎的锁机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MyISAM手动更改优先级"><span class="nav-number">18.6.1.</span> <span class="nav-text">MyISAM手动更改优先级</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MyISAM的并发插入"><span class="nav-number">18.6.2.</span> <span class="nav-text">MyISAM的并发插入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#InnoDB引擎的锁机制"><span class="nav-number">18.7.</span> <span class="nav-text">InnoDB引擎的锁机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Innodb行锁模式以及加锁方法"><span class="nav-number">18.7.1.</span> <span class="nav-text">Innodb行锁模式以及加锁方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#表级锁和行级锁之间的冲突"><span class="nav-number">18.7.2.</span> <span class="nav-text">表级锁和行级锁之间的冲突</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#触发器-MySQL5"><span class="nav-number">19.</span> <span class="nav-text">触发器(MySQL5)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT触发器"><span class="nav-number">19.1.</span> <span class="nav-text">INSERT触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DELETE触发器"><span class="nav-number">19.2.</span> <span class="nav-text">DELETE触发器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE触发器"><span class="nav-number">19.3.</span> <span class="nav-text">UPDATE触发器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#视图（MySQL5-）"><span class="nav-number">20.</span> <span class="nav-text">视图（MySQL5 ）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建视图"><span class="nav-number">20.1.</span> <span class="nav-text">创建视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查看创建视图的语句"><span class="nav-number">20.2.</span> <span class="nav-text">查看创建视图的语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#更新视图"><span class="nav-number">20.3.</span> <span class="nav-text">更新视图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#存储过程-MySQL5"><span class="nav-number">21.</span> <span class="nav-text">存储过程(MySQL5)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#创建存储过程"><span class="nav-number">21.1.</span> <span class="nav-text">创建存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令行模式下的DELIMITER"><span class="nav-number">21.2.</span> <span class="nav-text">命令行模式下的DELIMITER //</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用存储过程"><span class="nav-number">21.3.</span> <span class="nav-text">使用存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#删除存储过程"><span class="nav-number">21.4.</span> <span class="nav-text">删除存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用参数"><span class="nav-number">21.5.</span> <span class="nav-text">使用参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查存储过程"><span class="nav-number">21.6.</span> <span class="nav-text">检查存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列出所有存储过程"><span class="nav-number">21.7.</span> <span class="nav-text">列出所有存储过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可以使用LIKE过滤-如"><span class="nav-number">21.8.</span> <span class="nav-text">可以使用LIKE过滤,如</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用游标-MySQL5"><span class="nav-number">21.9.</span> <span class="nav-text">使用游标(MySQL5)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#游标的使用"><span class="nav-number">21.9.1.</span> <span class="nav-text">游标的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建游标"><span class="nav-number">21.9.2.</span> <span class="nav-text">创建游标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#打开游标"><span class="nav-number">21.9.3.</span> <span class="nav-text">打开游标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关闭游标"><span class="nav-number">21.9.4.</span> <span class="nav-text">关闭游标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用游标数据"><span class="nav-number">21.9.5.</span> <span class="nav-text">使用游标数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#备份"><span class="nav-number">22.</span> <span class="nav-text">备份</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liisyu</span>

  

  
</div>






        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/blog/js/utils.js?v=7.1.0"></script>

  <script src="/blog/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/blog/js/schemes/muse.js?v=7.1.0"></script>



  
  <script src="/blog/js/scrollspy.js?v=7.1.0"></script>
<script src="/blog/js/post-details.js?v=7.1.0"></script>



  


  <script src="/blog/js/next-boot.js?v=7.1.0"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/blog/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

  <script type="text/javascript" src="/blog/js/clipboard.min.js"></script>  
  <script type="text/javascript" src="/blog/js/clipboard-use.js"></script>
</body>
</html>
